import{r as d,j as e,z as W,L as za,S as $a,U as Ba,B as Ke,C as ce,X as pe,b as Le,P as ze,c as Ye,D as ca,d as Fe,e as ta,f as Na,g as Ua,F as Va,G as Ga,h as fa,i as Ha,k as ka,M as Wa,l as ke,m as Aa,n as Ya,o as Be,p as Oe,q as Qa,s as ma,t as ua,u as Ja,v as Ta,x as Ka,y as ba,A as Fa,E as _e,H as Xa,I as Za,J as es,K as oa,N as as,O as ss,Q as ts,V as da,W as rs,Y as Oa,Z as os,_ as ns,$ as is,a0 as cs,a1 as ds,a2 as ls,a3 as ms,a4 as ha,a5 as Xe,a6 as us,a7 as ya,a8 as hs,a9 as ps,aa as xs,ab as fs}from"./react-BjM8j4--.js";import{i as js,g as gs,a as vs,b as Ns,o as bs,c as Te,d as G,s as ys,e as ws,f as pa,h as Cs,j as Es,r as Ps,u as Ds,k as Ss,l as ee,q as ne,m as Q,w as te,n as ge,p as oe,t as ue,v as he,x as Is,y as Ne,T as ye,z as zs}from"./firebase-D6_BU05Q.js";import{N as ks,u as la,L as na,B as As,R as Ts,a as Ve}from"./router-HOwAlKtj.js";import{E as Fs}from"./mui-DKo0v7PS.js";import"./vendor-RZtktqDz.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();const je={home:"/",forgotPassword:"/forgot-password",login:"/login",register:"/register",dashboard:"/dashboard",cadastros:"/cadastros"},xa={apiKey:"AIzaSyDMjPxIn42jeTVD0qksgZjoM9JR7nxLTxo",authDomain:"cleber-9a012.firebaseapp.com",projectId:"cleber-9a012",storageBucket:"cleber-9a012.firebasestorage.app",messagingSenderId:"174918177595",appId:"1:174918177595:web:341eabeb3c8d8144a75d1e"};if(!xa.apiKey||!xa.authDomain)throw new Error("Firebase configuration is missing. Please check your .env file.");const ja=js(xa),Ge=gs(ja),D=vs(ja),Os=Ns(ja);function Ie(s){if(typeof s=="string")return s;const a=s?.code||"",t=s?.message||"";if(t.toLowerCase().includes("user-not-found")||t.toLowerCase().includes("there is no user record"))return"N√£o existe um usu√°rio cadastrado com este email. Verifique o email ou cadastre-se.";switch(a){case"auth/user-not-found":return"N√£o existe um usu√°rio cadastrado com este email. Verifique o email ou cadastre-se.";case"auth/wrong-password":return"Senha incorreta. Tente novamente.";case"auth/invalid-email":return"Email inv√°lido. Verifique o formato do email.";case"auth/invalid-credential":return t.toLowerCase().includes("user")||t.toLowerCase().includes("email")?"N√£o existe um usu√°rio cadastrado com este email. Verifique o email ou cadastre-se.":"Email ou senha incorretos. Verifique suas credenciais.";case"auth/too-many-requests":return"Muitas tentativas. Tente novamente em alguns minutos.";case"auth/user-disabled":return"Conta desabilitada. Entre em contato com o suporte.";case"auth/network-request-failed":return"Erro de conex√£o. Verifique sua internet.";case"auth/invalid-api-key":return"Erro de configura√ß√£o. Entre em contato com o suporte.";default:return t&&(t.toLowerCase().includes("user-not-found")||t.toLowerCase().includes("no user record"))?"N√£o existe um usu√°rio cadastrado com este email. Verifique o email ou cadastre-se.":"Erro ao fazer login. Verifique suas credenciais e tente novamente."}}const qe={async logOut(){try{await Es(Ge)}catch(s){const a=Ie(s);throw new Error(a)}},async login(s){try{const t=(await Cs(Ge,s.email,s.password)).user,o=await Te(G(D,"users",t.uid));if(!o.exists())throw new Error("N√£o existe um usu√°rio cadastrado com este email. Verifique o email ou cadastre-se.");const r={...o.data(),lastLogin:new Date};return await pa(G(D,"users",t.uid),r),r}catch(a){const t=Ie(a);throw new Error(t)}},async register(s){try{if(!s.email||!s.password||!s.name)throw new Error("Todos os campos s√£o obrigat√≥rios");if(s.password.length<6)throw new Error("A senha deve ter pelo menos 6 caracteres");const t=(await ws(Ge,s.email,s.password)).user,o={uid:t.uid,email:s.email,name:s.name,createdAt:new Date,updatedAt:new Date,lastLogin:new Date,role:s.role||"user"};return await pa(G(D,"users",t.uid),o),o}catch(a){const t=Ie(a);throw new Error(t)}},async resetPassword(s){try{await ys(Ge,s)}catch(a){const t=Ie(a);throw new Error(t)}},observeAuthState(s){try{return bs(Ge,async a=>{if(a)try{const t=await Te(G(D,"users",a.uid));if(t.exists()){const o=t.data();s(o)}else s(null)}catch(t){console.error("Erro ao buscar dados do usu√°rio:",t),s(null)}else s(null)})}catch(a){throw new Error("Erro ao observar estado de autentica√ß√£o: "+a)}}},_a=d.createContext(void 0);function _s({children:s}){const[a,t]=d.useState(null),[o,n]=d.useState(!0),[r,i]=d.useState(null);d.useEffect(()=>{const v=qe.observeAuthState(p=>{t(p),n(!1)});return()=>v()},[]);const f={user:a,loading:o,error:r,login:async v=>{try{n(!0),i(null);const p=await qe.login(v);t(p),n(!1),W.success(`Bem-vindo, ${p.name||p.email}!`,{icon:e.jsx(Ba,{size:20})})}catch(p){const m=Ie(p);i(m),n(!1),t(null),W.error(m)}},register:async v=>{try{n(!0),i(null);const p=await qe.register(v);t(p),n(!1),W.success("Conta criada com sucesso! Bem-vindo!",{icon:e.jsx($a,{size:20})})}catch(p){const m=Ie(p);i(m),n(!1),t(null),W.error(m)}},logout:async()=>{try{n(!0),i(null),await qe.logOut(),t(null),n(!1),W.success("Logout realizado com sucesso!",{icon:e.jsx(za,{size:20})})}catch(v){const p=Ie(v);i(p),n(!1),W.error(p)}},clearError:()=>{i(null)}};return e.jsx(_a.Provider,{value:f,children:s})}const le=()=>{const s=d.useContext(_a);if(s===void 0)throw new Error("useAuth deve ser usado dentro de um AuthProvider");return s},Ls=({children:s})=>{const{user:a,loading:t}=le();return t?e.jsx("div",{children:"Loading..."}):a?e.jsx(e.Fragment,{children:s}):e.jsx(ks,{to:je.login,replace:!0})},Ue=({variant:s="primary",size:a="md",isLoading:t=!1,children:o,className:n="",disabled:r,...i})=>{const u=`btn--${s}`,c=`btn--${a}`,x=`btn ${u} ${c} ${n}`.trim();return e.jsxs("button",{className:x,disabled:r||t,...i,children:[t&&e.jsxs("svg",{className:"btn__spinner",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",opacity:"0.25"}),e.jsx("path",{fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",opacity:"0.75"})]}),o]})},wa=()=>{const[s,a]=d.useState({email:"",password:""}),[t,o]=d.useState(!1),{login:n,error:r,loading:i,clearError:l}=le(),u=la(),c=f=>{const{name:v,value:p}=f.target;a(m=>({...m,[v]:p})),r&&l()},x=async f=>{if(f.preventDefault(),!s.email||!s.password){alert("Por favor, preencha todos os campos");return}try{await n(s),u(je.dashboard)}catch(v){console.error("Erro ao fazer login:",v)}};return e.jsx("div",{className:"login-container",children:e.jsx("div",{className:"login-form-container",children:e.jsxs("div",{className:"login-form-card",children:[e.jsxs("div",{className:"login-header",children:[e.jsx("h2",{className:"login-title",children:"Entrar"}),e.jsx("p",{className:"login-subtitle",children:"Preencha os campos abaixo para entrar em sua conta"})]}),e.jsxs("form",{className:"login-form",onSubmit:x,children:[r&&e.jsxs("div",{className:"login-error",role:"alert",children:[e.jsx(Fs,{className:"login-error-icon"}),e.jsx("span",{children:r})]}),e.jsxs("div",{className:"login-field",children:[e.jsx("label",{className:"login-label",htmlFor:"email",children:"Email"}),e.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:s.email,onChange:c,placeholder:"Digite seu email",className:"login-input"})]}),e.jsxs("div",{className:"login-field",children:[e.jsx("label",{className:"login-label",htmlFor:"password",children:"Senha"}),e.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:s.password,onChange:c,placeholder:"Digite sua senha",className:"login-input"})]}),e.jsxs("div",{className:"login-options",children:[e.jsxs("div",{className:"login-checkbox-container",children:[e.jsx("input",{id:"rememberMe",name:"rememberMe",type:"checkbox",checked:t,onChange:f=>o(f.target.checked),className:"login-checkbox"}),e.jsx("label",{className:"login-checkbox-label",htmlFor:"rememberMe",children:"Lembrar-me"})]}),e.jsx(na,{to:je.forgotPassword,className:"login-link",children:"Esqueceu sua senha?"})," "]}),e.jsx("div",{className:"login-buttons",children:e.jsx(Ue,{type:"submit",size:"lg",isLoading:i,disabled:!s.email||!s.password,className:"login-button",children:i?"Entrando...":"Entrar"})}),e.jsx("div",{className:"login-footer",children:e.jsxs("span",{className:"login-footer-text",children:["N√£o tem uma conta?"," ",e.jsx(na,{to:je.register,className:"login-footer-link",children:"Cadastrar"})]})})]})]})})})},La=s=>{if(!s)return"";const t=s.replace(/\D/g,"").substring(0,11);return t.length<=10?t.replace(/^(\d{2})(\d)/g,"($1) $2").replace(/(\d{4})(\d)/,"$1-$2"):t.replace(/^(\d{2})(\d)/g,"($1) $2").replace(/(\d{5})(\d)/,"$1-$2")},Rs=s=>{if(!s)return 0;const a=s.replace(/\D/g,"");return Number(a)/100},qs=()=>{const[s,a]=d.useState({name:"",email:"",password:"",confirmPassword:"",phone:"",role:"user"}),[t,o]=d.useState(!1),{register:n,error:r,loading:i,clearError:l}=le(),u=la(),c=v=>{const{name:p,value:m}=v.target,g=p==="phone"?La(m):m;a(N=>({...N,[p]:g})),r&&l()},x=()=>!s.name||!s.email||!s.password||!s.confirmPassword?"Todos os campos s√£o obrigat√≥rios":s.password.length<6?"A senha deve ter pelo menos 6 caracteres":s.password!==s.confirmPassword?"As senhas n√£o coincidem":t?null:"Voc√™ deve aceitar os termos de uso",f=async v=>{v.preventDefault();const p=x();if(p){alert(p);return}try{await n(s),u(je.dashboard)}catch(m){console.error("Erro ao registrar usu√°rio:",m)}};return e.jsx("div",{className:"register-container",children:e.jsx("div",{className:"register-form-container",children:e.jsxs("div",{className:"register-form-card",children:[e.jsxs("div",{className:"register-header",children:[e.jsx("h2",{className:"register-title",children:"Criar Conta"}),e.jsx("p",{className:"register-subtitle",children:"Preencha os campos abaixo para criar sua conta"})]}),e.jsxs("form",{className:"register-form",onSubmit:f,children:[r&&e.jsx("div",{className:"register-error",children:r}),e.jsxs("div",{className:"register-field",children:[e.jsx("label",{className:"register-label",htmlFor:"name",children:"Nome"}),e.jsx("input",{required:!0,autoComplete:"name",className:"register-input",type:"text",id:"name",name:"name",value:s.name,onChange:c,placeholder:"Digite seu nome"})]}),e.jsxs("div",{className:"register-field",children:[e.jsx("label",{className:"register-label",htmlFor:"email",children:"Email"}),e.jsx("input",{required:!0,autoComplete:"email",className:"register-input",type:"email",id:"email",name:"email",value:s.email,onChange:c,placeholder:"Digite seu email"})]}),e.jsxs("div",{className:"register-field",children:[e.jsx("label",{htmlFor:"phone",className:"register-label",children:"Telefone (Opcional)"}),e.jsx("input",{id:"phone",name:"phone",type:"tel",autoComplete:"tel",value:s.phone,onChange:c,className:"register-input",placeholder:"(11) 99999-9999",maxLength:15})]}),e.jsxs("div",{className:"register-field",children:[e.jsx("label",{htmlFor:"password",className:"register-label",children:"Senha"}),e.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,value:s.password,onChange:c,className:"register-input",placeholder:"Digite sua senha (m√≠n. 6 caracteres)"})]}),e.jsxs("div",{className:"register-field",children:[e.jsx("label",{htmlFor:"confirmPassword",className:"register-label",children:"Confirmar senha"}),e.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",autoComplete:"new-password",required:!0,value:s.confirmPassword,onChange:c,className:"register-input",placeholder:"Confirme sua senha"})]}),e.jsxs("div",{className:"register-checkbox-container",children:[e.jsx("input",{id:"accept-terms",name:"accept-terms",type:"checkbox",checked:t,onChange:v=>o(v.target.checked),className:"register-checkbox"}),e.jsxs("label",{htmlFor:"accept-terms",className:"register-checkbox-label",children:["Concordo com os"," ",e.jsx("a",{href:"#",className:"register-terms-link",children:"Termos de Uso"})," ","e"," ",e.jsx("a",{href:"#",className:"register-terms-link",children:"Pol√≠tica de Privacidade"})]})]}),e.jsx("div",{className:"register-buttons",children:e.jsx(Ue,{type:"submit",variant:"primary",size:"lg",isLoading:i,disabled:!s.name||!s.email||!s.password||!s.confirmPassword||!t,className:"register-button",children:i?"Cadastrando...":"Cadastrar"})}),e.jsx("div",{className:"register-footer",children:e.jsxs("p",{className:"register-footer-text",children:["J√° tem uma conta?"," ",e.jsx(na,{to:je.login,className:"register-footer-link",children:"Entrar"})]})})]})]})})})},Ca="company_info",ra={async getCompanyInfo(){try{const s=G(D,"company",Ca),a=await Te(s);return a.exists()?{id:a.id,...a.data()}:null}catch(s){throw console.error("Erro ao buscar informa√ß√µes da empresa:",s),s}},async saveCompanyInfo(s){try{const a=G(D,"company",Ca);await pa(a,{...s,updatedAt:ee()},{merge:!0})}catch(a){throw console.error("Erro ao salvar informa√ß√µes da empresa:",a),a}},async uploadLogo(s){try{const a=Ps(Os,`company/logo_${Date.now()}_${s.name}`);return await Ds(a,s),await Ss(a)}catch(a){throw console.error("Erro ao fazer upload da logo:",a),a}}},be="notifications",fe={async createNotification(s){try{const a=new Date;return{id:(await Ne(Q(D,be),{...s,read:!1,createdAt:ye.fromDate(a)})).id,...s,read:!1,createdAt:a}}catch(a){throw console.error("Erro ao criar notifica√ß√£o:",a),new Error("Erro ao criar notifica√ß√£o")}},async getNotificationsByUser(s){try{const a=ne(Q(D,be),te("userId","==",s),ge("createdAt","desc"),Is(50)),t=await oe(a),o=[];return t.forEach(n=>{const r=n.data();o.push({id:n.id,userId:r.userId,type:r.type,title:r.title,message:r.message,read:r.read,link:r.link,metadata:r.metadata,createdAt:r.createdAt.toDate()})}),o}catch(a){throw console.error("Erro ao buscar notifica√ß√µes:",a),new Error("Erro ao buscar notifica√ß√µes")}},async getUnreadNotifications(s){try{const a=ne(Q(D,be),te("userId","==",s),te("read","==",!1),ge("createdAt","desc")),t=await oe(a),o=[];return t.forEach(n=>{const r=n.data();o.push({id:n.id,userId:r.userId,type:r.type,title:r.title,message:r.message,read:r.read,link:r.link,metadata:r.metadata,createdAt:r.createdAt.toDate()})}),o}catch(a){throw console.error("Erro ao buscar notifica√ß√µes n√£o lidas:",a),new Error("Erro ao buscar notifica√ß√µes n√£o lidas")}},async markAsRead(s){try{const a=G(D,be,s);await he(a,{read:!0})}catch(a){throw console.error("Erro ao marcar notifica√ß√£o como lida:",a),new Error("Erro ao marcar notifica√ß√£o como lida")}},async markAllAsRead(s){try{const a=ne(Q(D,be),te("userId","==",s),te("read","==",!1)),t=await oe(a),o=[];t.forEach(n=>{o.push(he(G(D,be,n.id),{read:!0}))}),await Promise.all(o)}catch(a){throw console.error("Erro ao marcar todas como lidas:",a),new Error("Erro ao marcar todas como lidas")}},async deleteNotification(s){try{await ue(G(D,be,s))}catch(a){throw console.error("Erro ao deletar notifica√ß√£o:",a),new Error("Erro ao deletar notifica√ß√£o")}},async deleteOldNotifications(s){try{const a=ne(Q(D,be),te("userId","==",s),ge("createdAt","desc")),t=await oe(a),o=[],n=new Date;n.setDate(n.getDate()-30);let r=0;t.forEach(i=>{const l=i.data(),u=l.createdAt.toDate(),c=l.read;if(u<n){o.push(ue(G(D,be,i.id)));return}c&&(r++,r>100&&o.push(ue(G(D,be,i.id))))}),o.length>0&&(await Promise.all(o),console.log(`üóëÔ∏è ${o.length} notifica√ß√µes antigas deletadas para usu√°rio ${s}`))}catch(a){console.error("Erro ao deletar notifica√ß√µes antigas:",a)}}},Ms=s=>{const[a,t]=d.useState([]),[o,n]=d.useState(0),[r,i]=d.useState(!0),l=d.useCallback(async()=>{if(s)try{i(!0);const[f,v]=await Promise.all([fe.getNotificationsByUser(s),fe.getUnreadNotifications(s)]);t(f),n(v.length)}catch(f){console.error("Erro ao carregar notifica√ß√µes:",f)}finally{i(!1)}},[s]);return d.useEffect(()=>{l(),s&&fe.deleteOldNotifications(s);const f=setInterval(()=>{s&&l()},3e4);return()=>clearInterval(f)},[s,l]),{notifications:a,unreadCount:o,loading:r,markAsRead:async f=>{try{await fe.markAsRead(f),await l()}catch(v){console.error("Erro ao marcar notifica√ß√£o como lida:",v)}},markAllAsRead:async()=>{if(s)try{await fe.markAllAsRead(s),await l()}catch(f){console.error("Erro ao marcar todas as notifica√ß√µes como lidas:",f)}},deleteNotification:async f=>{try{await fe.deleteNotification(f),await l()}catch(v){console.error("Erro ao deletar notifica√ß√£o:",v)}},refresh:l}},$s=({onNavigate:s})=>{const{user:a}=le(),{notifications:t,unreadCount:o,loading:n,markAsRead:r,markAllAsRead:i,deleteNotification:l}=Ms(a?.uid||""),[u,c]=d.useState(!1),x=d.useRef(null);d.useEffect(()=>{const N=C=>{x.current&&!x.current.contains(C.target)&&c(!1)};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]);const f=N=>{switch(N){case"ordem_prazo":return e.jsx(Fe,{size:20,className:"notification-icon warning"});case"pagamento_vencendo":return e.jsx(ca,{size:20,className:"notification-icon danger"});case"etapa_parada":return e.jsx(Ye,{size:20,className:"notification-icon alert"});case"ordem_concluida":return e.jsx(ze,{size:20,className:"notification-icon success"});default:return e.jsx(Ke,{size:20,className:"notification-icon info"})}},v=async N=>{N.read||await r(N.id),N.link&&s&&(s(N.link),c(!1))},p=async()=>{await i()},m=async(N,C)=>{N.stopPropagation(),await l(C)},g=N=>{const q=new Date().getTime()-N.getTime(),F=Math.floor(q/6e4),_=Math.floor(F/60),M=Math.floor(_/24);return F<1?"Agora":F<60?`${F}min atr√°s`:_<24?`${_}h atr√°s`:M===1?"Ontem":M<7?`${M} dias atr√°s`:N.toLocaleDateString("pt-BR")};return e.jsxs("div",{className:"notification-center",ref:x,children:[e.jsxs("button",{className:"notification-bell",onClick:()=>c(!u),"aria-label":"Notifica√ß√µes",children:[e.jsx(Ke,{size:20}),o>0&&e.jsx("span",{className:"notification-badge",children:o})]}),u&&e.jsxs("div",{className:"notification-dropdown",children:[e.jsxs("div",{className:"notification-header",children:[e.jsxs("div",{className:"notification-header-title",children:[e.jsx(Ke,{size:20}),e.jsx("h3",{children:"Notifica√ß√µes"}),o>0&&e.jsx("span",{className:"unread-count-badge",children:o})]}),e.jsxs("div",{className:"notification-header-actions",children:[o>0&&e.jsx("button",{className:"mark-all-read-btn",onClick:p,title:"Marcar todas como lidas",children:e.jsx(ce,{size:20})}),e.jsx("button",{className:"close-dropdown-btn",onClick:()=>c(!1),title:"Fechar",children:e.jsx(pe,{size:20})})]})]}),e.jsx("div",{className:"notification-content",children:n?e.jsx("div",{className:"notification-loading",children:e.jsx("p",{children:"Carregando..."})}):t.length===0?e.jsxs("div",{className:"notification-empty",children:[e.jsx(Ke,{size:48}),e.jsx("p",{children:"Nenhuma notifica√ß√£o"})]}):e.jsx("div",{className:"notification-list",children:t.map(N=>e.jsxs("div",{className:`notification-item ${N.read?"":"unread"}`,onClick:()=>v(N),children:[e.jsx("div",{className:"notification-item-icon",children:f(N.type)}),e.jsxs("div",{className:"notification-item-content",children:[e.jsx("h4",{className:"notification-item-title",children:N.title}),e.jsx("p",{className:"notification-item-message",children:N.message}),e.jsx("span",{className:"notification-item-time",children:g(N.createdAt)})]}),e.jsx("button",{className:"notification-item-delete",onClick:C=>m(C,N.id),title:"Remover",children:e.jsx(Le,{size:14})})]},N.id))})})]})]})},Bs=({children:s,activeTab:a="dashboard",onTabChange:t})=>{const[o,n]=ta.useState(!1),[r,i]=ta.useState(null),l=la();ta.useEffect(()=>{c();const m=()=>{c()};return window.addEventListener("companyInfoUpdated",m),()=>{window.removeEventListener("companyInfoUpdated",m)}},[]);const u=async()=>{try{await qe.logOut(),l("/login")}catch(m){console.error("Erro ao deslogar:",m)}},c=async()=>{try{const m=await ra.getCompanyInfo();i(m)}catch(m){console.error("Erro ao carregar informa√ß√µes da empresa:",m)}},x=()=>{n(!o)},f=[{icon:Na,label:"Dashboard",key:"dashboard"},{icon:Ua,label:"Cadastros",key:"cadastros"},{icon:Va,label:"Fac√ß√µes",key:"faccoes"},{icon:Ga,label:"Etapas",key:"etapas"},{icon:ze,label:"Produto",key:"produto"},{icon:fa,label:"Ordem de Produ√ß√µes",key:"ordemProducoes"},{icon:Ha,label:"Gest√£o de Produ√ß√µes",key:"gestaoProducoes"},{icon:ca,label:"Financeiro",key:"financeiro"},{icon:ka,label:"Relat√≥rios",key:"relatorios"}],v=m=>{t&&t(m)},p=m=>{t&&t(m)};return e.jsxs("div",{className:"layout-container",children:[e.jsxs("aside",{className:`sidebar ${o?"sidebar-open":""}`,children:[e.jsxs("div",{className:"sidebar-header",children:[e.jsxs("div",{className:"sidebar-logo",children:[r?.logoUrl?e.jsx("img",{src:r.logoUrl,alt:r.nome||"Logo",className:"company-logo-img"}):e.jsx(Na,{className:"logo-icon"}),e.jsxs("div",{className:"company-info",children:[e.jsx("span",{className:"logo-text",children:r?.nome||"Nome da empresa"}),r?.endereco&&e.jsx("span",{className:"company-address",children:r.endereco})]})]}),e.jsx("button",{className:"sidebar-close-btn",onClick:x,children:e.jsx(pe,{size:20})})]}),e.jsx("nav",{className:"sidebar-nav",children:e.jsx("ul",{className:"nav-list",children:f.map((m,g)=>e.jsx("li",{className:"nav-item",children:e.jsxs("button",{onClick:()=>v(m.key),className:`nav-link ${a===m.key?"nav-link-active":""}`,children:[e.jsx(m.icon,{size:20,className:"nav-icon"}),e.jsx("span",{className:"nav-label",children:m.label})]})},g))})}),e.jsx("div",{className:"sidebar-footer",children:e.jsxs("button",{className:"logout-btn",onClick:u,children:[e.jsx(za,{size:20}),e.jsx("span",{children:"Sair"})]})})]}),e.jsxs("div",{className:"main-content",children:[e.jsxs("header",{className:"header",children:[e.jsxs("div",{className:"header-left",children:[e.jsx("button",{className:"menu-toggle",onClick:x,children:e.jsx(Wa,{size:24})}),e.jsx("h1",{className:"header-title",children:"Sistema de Gest√£o de Produ√ß√£o T√™xtil"})]}),e.jsx("div",{className:"header-right",children:e.jsx($s,{onNavigate:p})})]}),e.jsx("main",{className:"page-content",children:s})]}),o&&e.jsx("div",{className:"sidebar-overlay",onClick:x})]})},Ze="ordensProducao",Us="counters";async function Vs(s){const a=G(D,Us,`op_counter_${s}`);try{const t=await zs(D,async o=>{const n=await o.get(a);let r=1;return n.exists()&&(r=n.data().lastNumber+1),o.set(a,{lastNumber:r,updatedAt:ee()},{merge:!0}),r});return`OP-${String(t).padStart(4,"0")}`}catch(t){return console.error("Erro ao gerar n√∫mero da OP:",t),`OP-${Date.now()}`}}const Pe={async getOrders(s){const a=ne(Q(D,Ze),te("userId","==",s),ge("createdAt","desc"));return(await oe(a)).docs.map(o=>{const n=o.data();return{id:o.id,codigo:n.codigo,produtoId:n.produtoId,produtoDescricao:n.produtoDescricao,produtoRef:n.produtoRef,prioridade:n.prioridade,status:n.status,dataInicio:n.dataInicio,dataPrevista:n.dataPrevista,responsavelId:n.responsavelId||void 0,responsavelNome:n.responsavelNome||void 0,createdAt:n.createdAt?.toDate()??new Date,updatedAt:n.updatedAt?.toDate()??new Date,userId:n.userId,grade:n.grade??[]}})},async createOrder(s,a,t,o){const n=await Vs(s),r=a.grade.map(i=>({...i,total:Object.values(i.quantidades).reduce((l,u)=>l+u,0)}));await Ne(Q(D,Ze),{produtoId:a.produtoId,produtoDescricao:t.descricao,produtoRef:t.refCodigo,prioridade:a.prioridade,dataInicio:a.dataInicio,dataPrevista:a.dataPrevista,responsavelId:a.responsavelId||null,responsavelNome:o||null,grade:r,userId:s,status:"em_producao",codigo:n,createdAt:ee(),updatedAt:ee()})},async updateOrder(s,a,t,o){const n=a.grade.map(r=>({...r,total:Object.values(r.quantidades).reduce((i,l)=>i+l,0)}));await he(G(D,Ze,s),{produtoId:a.produtoId,produtoDescricao:t.descricao,produtoRef:t.refCodigo,prioridade:a.prioridade,dataInicio:a.dataInicio,dataPrevista:a.dataPrevista,responsavelId:a.responsavelId||null,responsavelNome:o||null,grade:n,updatedAt:ee()})},async deleteOrder(s){await ue(G(D,Ze,s))}},ea={async getCategorias(s){try{const a=ne(Q(D,"categorias"),te("userId","==",s),ge("nome","asc"));return(await oe(a)).docs.map(o=>({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate()}))}catch(a){throw console.error("Erro ao buscar categorias:",a),a}},async createCategoria(s,a){try{return(await Ne(Q(D,"categorias"),{...a,userId:s,ativo:!0,createdAt:ee()})).id}catch(t){throw console.error("Erro ao criar categoria:",t),t}},async updateCategoria(s,a){try{await he(G(D,"categorias",s),{...a,updatedAt:ee()})}catch(t){throw console.error("Erro ao atualizar categoria:",t),t}},async deleteCategoria(s){try{await ue(G(D,"categorias",s))}catch(a){throw console.error("Erro ao deletar categoria:",a),a}}},We={async getCores(s){try{const a=ne(Q(D,"cores"),te("userId","==",s),ge("nome","asc"));return(await oe(a)).docs.map(o=>({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate()}))}catch(a){throw console.error("Erro ao buscar cores:",a),a}},async createCor(s,a){try{return(await Ne(Q(D,"cores"),{...a,userId:s,ativo:!0,createdAt:ee()})).id}catch(t){throw console.error("Erro ao criar cor:",t),t}},async updateCor(s,a){try{await he(G(D,"cores",s),{...a,updatedAt:ee()})}catch(t){throw console.error("Erro ao atualizar cor:",t),t}},async deleteCor(s){try{await ue(G(D,"cores",s))}catch(a){throw console.error("Erro ao deletar cor:",a),a}}},Me={async getTamanhos(s){try{const a=ne(Q(D,"tamanhos"),te("userId","==",s),ge("ordem","asc"));return(await oe(a)).docs.map(o=>({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate()}))}catch(a){throw console.error("Erro ao buscar tamanhos:",a),a}},async createTamanho(s,a){try{return(await Ne(Q(D,"tamanhos"),{...a,userId:s,ativo:!0,createdAt:ee()})).id}catch(t){throw console.error("Erro ao criar tamanho:",t),t}},async updateTamanho(s,a){try{await he(G(D,"tamanhos",s),{...a,updatedAt:ee()})}catch(t){throw console.error("Erro ao atualizar tamanho:",t),t}},async deleteTamanho(s){try{await ue(G(D,"tamanhos",s))}catch(a){throw console.error("Erro ao deletar tamanho:",a),a}}},we={async getProdutos(s){try{const a=ne(Q(D,"produtos"),te("userId","==",s));return(await oe(a)).docs.map(n=>{const r=n.data();return{id:n.id,refCodigo:r.refCodigo||"",descricao:r.descricao||"",categoria:{id:"",nome:"",ativo:!0,createdAt:new Date},cores:[],tamanhos:[],etapasProducao:[],categoriaId:r.categoriaId||"",coresIds:r.coresIds||[],tamanhosIds:r.tamanhosIds||[],etapasProducaoIds:r.etapasProducaoIds||[],ativo:r.ativo!==!1,userId:r.userId,createdAt:r.createdAt?.toDate()||new Date,updatedAt:r.updatedAt?.toDate()||new Date}}).sort((n,r)=>{const i=parseInt(n.refCodigo)||0,l=parseInt(r.refCodigo)||0;return i-l})}catch(a){throw console.error("Erro ao buscar produtos:",a),a}},async createProduto(s,a){try{if(!a.etapasProducao||a.etapasProducao.length===0)throw new Error("O produto deve ter pelo menos uma etapa de produ√ß√£o definida");return(await Ne(Q(D,"produtos"),{refCodigo:a.refCodigo,descricao:a.descricao,categoriaId:a.categoriaId,coresIds:a.coresIds,tamanhosIds:a.tamanhosIds,etapasProducaoIds:a.etapasProducao||[],userId:s,ativo:!0,createdAt:ee(),updatedAt:ee()})).id}catch(t){throw console.error("Erro ao criar produto:",t),t}},async updateProduto(s,a){try{if(!a.etapasProducao||a.etapasProducao.length===0)throw new Error("O produto deve ter pelo menos uma etapa de produ√ß√£o definida");await he(G(D,"produtos",s),{refCodigo:a.refCodigo,descricao:a.descricao,categoriaId:a.categoriaId,coresIds:a.coresIds,tamanhosIds:a.tamanhosIds,etapasProducaoIds:a.etapasProducao||[],updatedAt:ee()})}catch(t){throw console.error("Erro ao atualizar produto:",t),t}},async deleteProduto(s){try{await ue(G(D,"produtos",s))}catch(a){throw console.error("Erro ao deletar produto:",a),a}}},aa="faccoes",Ce={async createFaccao(s){try{return(await Ne(Q(D,aa),{...s,createdAt:ee(),updatedAt:ee()})).id}catch(a){throw new Error(`Erro ao criar fac√ß√£o: ${a instanceof Error?a.message:"Erro desconhecido"}`)}},async getFaccoes(){try{const s=ne(Q(D,aa),ge("nome","asc"));return(await oe(s)).docs.map(t=>({id:t.id,...t.data()}))}catch(s){throw new Error(`Erro ao buscar fac√ß√µes: ${s instanceof Error?s.message:"Erro desconhecido"}`)}},async updateFaccao(s,a){try{const t=G(D,aa,s);await he(t,{...a,updatedAt:ee()})}catch(t){throw new Error(`Erro ao atualizar fac√ß√£o: ${t instanceof Error?t.message:"Erro desconhecido"}`)}},async deleteFaccao(s){try{await ue(G(D,aa,s))}catch(a){throw new Error(`Erro ao deletar fac√ß√£o: ${a instanceof Error?a.message:"Erro desconhecido"}`)}}},Gs=Object.freeze(Object.defineProperty({__proto__:null,faccaoService:Ce},Symbol.toStringTag,{value:"Module"})),$e=s=>{const a={};return Object.keys(s).forEach(t=>{const o=s[t];o!==void 0&&(a[t]=o)}),a},sa=s=>s.toISOString().split("T")[0],ia=(s,a)=>{const t=new Date(s),o=new Date(a);t.setHours(0,0,0,0),o.setHours(0,0,0,0);const n=t.getTime()-o.getTime(),r=n/(1e3*60*60*24);return n>=0?Math.ceil(r):Math.floor(r)},Ae="producaoProgresso",xe={async getProgressByOrderId(s){const a=ne(Q(D,Ae),te("ordemProducaoId","==",s)),t=await oe(a);if(t.empty)return null;const o=t.docs[0],n=o.data();return{id:o.id,ordemProducaoId:n.ordemProducaoId,etapas:n.etapas??[],createdAt:n.createdAt?.toDate()??new Date,updatedAt:n.updatedAt?.toDate()??new Date,userId:n.userId}},async getAllProgress(s){const a=ne(Q(D,Ae),te("userId","==",s),ge("updatedAt","desc"));return(await oe(a)).docs.map(o=>{const n=o.data();return{id:o.id,ordemProducaoId:n.ordemProducaoId,etapas:n.etapas??[],createdAt:n.createdAt?.toDate()??new Date,updatedAt:n.updatedAt?.toDate()??new Date,userId:n.userId}})},async initializeProgress(s,a,t){if(await this.getProgressByOrderId(a))return;const r=t.sort((i,l)=>i.order-l.order).map((i,l)=>{const u={etapaId:i.id,etapaNome:i.name,ordem:i.order,finalizadas:0,defeituosas:0,status:l===0?"em_andamento":"pausada"};return l===0&&(u.dataInicio=sa(new Date)),u}).map(i=>$e(i));await Ne(Q(D,Ae),{ordemProducaoId:a,etapas:r,userId:s,createdAt:ee(),updatedAt:ee()})},async updateStageProgress(s,a){const t=G(D,Ae,s),o=await Te(t);if(!o.exists())throw new Error("Progresso n√£o encontrado");const r=o.data().etapas??[],i=r.findIndex(x=>x.etapaId===a.etapaId);if(i===-1)throw new Error("Etapa n√£o encontrada no progresso");const l=r[i],u={};a.finalizadas!==void 0&&(u.finalizadas=a.finalizadas),a.defeituosas!==void 0&&(u.defeituosas=a.defeituosas),a.responsavelId!==void 0&&(u.responsavelId=a.responsavelId),a.status!==void 0&&(u.status=a.status),a.dataFim!==void 0&&(u.dataFim=a.dataFim),r[i]={etapaId:l.etapaId,etapaNome:l.etapaNome,ordem:l.ordem,finalizadas:u.finalizadas??l.finalizadas??0,defeituosas:u.defeituosas??l.defeituosas??0,status:u.status??l.status,...u},l.responsavelId&&(r[i].responsavelId=l.responsavelId),l.responsavelNome&&(r[i].responsavelNome=l.responsavelNome),l.dataInicio&&(r[i].dataInicio=l.dataInicio),l.observacoes&&l.observacoes.length>0&&(r[i].observacoes=l.observacoes);const c=r.map(x=>$e(x));await he(t,{etapas:c,updatedAt:ee()})},async finalizeStage(s,a,t,o=0){await this.updateStageProgress(s,{etapaId:a,finalizadas:t,defeituosas:o,status:"finalizada",dataFim:sa(new Date)})},async pauseStage(s,a){await this.updateStageProgress(s,{etapaId:a,status:"pausada"})},async resumeStage(s,a){await this.updateStageProgress(s,{etapaId:a,status:"em_andamento"})},async finalizeStageWithDetails(s,a,t,o,n){try{const r=G(D,Ae,s),i=await Te(r);if(!i.exists())throw new Error("Progresso n√£o encontrado");const x=(i.data().etapas||[]).map(f=>{if(f.etapaId===a){const p={etapaId:f.etapaId,etapaNome:f.etapaNome,ordem:f.ordem,finalizadas:t,defeituosas:o,status:"finalizada",dataFim:sa(new Date)};return f.responsavelId&&(p.responsavelId=f.responsavelId),f.responsavelNome&&(p.responsavelNome=f.responsavelNome),f.dataInicio&&(p.dataInicio=f.dataInicio),n?p.observacoes=[n]:f.observacoes&&f.observacoes.length>0&&(p.observacoes=f.observacoes),p}const v={etapaId:f.etapaId,etapaNome:f.etapaNome,ordem:f.ordem,finalizadas:f.finalizadas||0,defeituosas:f.defeituosas||0,status:f.status};return f.responsavelId&&(v.responsavelId=f.responsavelId),f.responsavelNome&&(v.responsavelNome=f.responsavelNome),f.dataInicio&&(v.dataInicio=f.dataInicio),f.dataFim&&(v.dataFim=f.dataFim),f.observacoes&&f.observacoes.length>0&&(v.observacoes=f.observacoes),v}).map(f=>$e(f));await he(r,{etapas:x,updatedAt:ee()})}catch(r){throw console.error("Erro ao finalizar etapa:",r),r}},async startNextStage(s,a,t,o){try{const n=G(D,Ae,s),r=await Te(n);if(!r.exists())throw new Error("Progresso n√£o encontrado");const c=(r.data().etapas||[]).map(x=>{if(x.etapaId===a)return{etapaId:x.etapaId,etapaNome:x.etapaNome,ordem:x.ordem,status:"em_andamento",responsavelId:t,responsavelNome:o,dataInicio:sa(new Date),finalizadas:0,defeituosas:0};const f={etapaId:x.etapaId,etapaNome:x.etapaNome,ordem:x.ordem,finalizadas:x.finalizadas||0,defeituosas:x.defeituosas||0,status:x.status};return x.responsavelId&&(f.responsavelId=x.responsavelId),x.responsavelNome&&(f.responsavelNome=x.responsavelNome),x.dataInicio&&(f.dataInicio=x.dataInicio),x.dataFim&&(f.dataFim=x.dataFim),x.observacoes&&x.observacoes.length>0&&(f.observacoes=x.observacoes),f}).map(x=>$e(x));await he(n,{etapas:c,updatedAt:ee()})}catch(n){throw console.error("Erro ao iniciar pr√≥xima etapa:",n),n}},async deleteProgress(s){try{await ue(G(D,Ae,s))}catch(a){throw console.error("Erro ao deletar progresso:",a),a}}},Se="lancamentosFinanceiros",Ee={async createLancamento(s,a){try{const t=$e({...s,dataVencimento:ye.fromDate(s.dataVencimento),status:"pendente",userId:a,createdAt:ee(),updatedAt:ee()});return(await Ne(Q(D,Se),t)).id}catch(t){throw console.error("Erro ao criar lan√ßamento financeiro:",t),t}},async getLancamentosByUser(s){try{const a=ne(Q(D,Se),te("userId","==",s),ge("dataVencimento","desc"));return(await oe(a)).docs.map(o=>{const n=o.data();return{id:o.id,...n,dataVencimento:n.dataVencimento?.toDate()||new Date,dataPagamento:n.dataPagamento?.toDate(),createdAt:n.createdAt?.toDate()||new Date,updatedAt:n.updatedAt?.toDate()||new Date}})}catch(a){throw console.error("Erro ao buscar lan√ßamentos:",a),a}},async getLancamentosPendentes(s){try{const a=ne(Q(D,Se),te("userId","==",s),te("status","in",["pendente","atrasado"]),ge("dataVencimento","asc")),o=(await oe(a)).docs.map(r=>{const i=r.data();return{id:r.id,...i,dataVencimento:i.dataVencimento?.toDate()||new Date,dataPagamento:i.dataPagamento?.toDate(),createdAt:i.createdAt?.toDate()||new Date,updatedAt:i.updatedAt?.toDate()||new Date}}),n=new Date;n.setHours(0,0,0,0);for(const r of o){const i=new Date(r.dataVencimento);i.setHours(0,0,0,0),r.status==="pendente"&&i<n&&(await this.updateLancamento(r.id,{status:"atrasado"}),r.status="atrasado")}return o}catch(a){throw console.error("Erro ao buscar lan√ßamentos pendentes:",a),a}},async getLancamentosPagos(s){try{const a=ne(Q(D,Se),te("userId","==",s),te("status","==","pago"),ge("dataPagamento","desc"));return(await oe(a)).docs.map(o=>{const n=o.data();return{id:o.id,...n,dataVencimento:n.dataVencimento?.toDate()||new Date,dataPagamento:n.dataPagamento?.toDate(),createdAt:n.createdAt?.toDate()||new Date,updatedAt:n.updatedAt?.toDate()||new Date}})}catch(a){throw console.error("Erro ao buscar lan√ßamentos pagos:",a),a}},async getLancamentoById(s){try{const a=G(D,Se,s),t=await Te(a);if(!t.exists())return null;const o=t.data();return{id:t.id,...o,dataVencimento:o.dataVencimento?.toDate()||new Date,dataPagamento:o.dataPagamento?.toDate(),createdAt:o.createdAt?.toDate()||new Date,updatedAt:o.updatedAt?.toDate()||new Date}}catch(a){throw console.error("Erro ao buscar lan√ßamento:",a),a}},async updateLancamento(s,a){try{const t=G(D,Se,s),o=$e({...a,dataPagamento:a.dataPagamento?ye.fromDate(a.dataPagamento):void 0,updatedAt:ee()});await he(t,o)}catch(t){throw console.error("Erro ao atualizar lan√ßamento:",t),t}},async marcarComoPago(s){try{await this.updateLancamento(s,{status:"pago",dataPagamento:new Date})}catch(a){throw console.error("Erro ao marcar lan√ßamento como pago:",a),a}},async deleteLancamento(s){try{await ue(G(D,Se,s))}catch(a){throw console.error("Erro ao deletar lan√ßamento:",a),a}},async deleteLancamentosByOrdem(s){try{const a=ne(Q(D,Se),te("ordemProducaoId","==",s)),o=(await oe(a)).docs.map(n=>ue(n.ref));await Promise.all(o)}catch(a){throw console.error("Erro ao deletar lan√ßamentos da ordem:",a),a}}},Hs=async(s,a)=>{try{const t=new Date;t.setHours(0,0,0,0);const o=new Date(t);o.setDate(o.getDate()+5);const r=(await fe.getNotificationsByUser(a)).filter(i=>i.type==="ordem_prazo");for(const i of s)if(i.status==="em_producao"){const l=new Date(i.dataPrevista);if(l.setHours(0,0,0,0),l>=t&&l<=o&&!r.some(c=>c.metadata?.ordemCodigo===i.codigo)){const c=ia(l,t);await fe.createNotification({userId:a,type:"ordem_prazo",title:"‚ö†Ô∏è Ordem Pr√≥xima do Prazo",message:`${i.codigo} - ${i.produtoDescricao} vence em ${c} dia(s)`,link:"gestaoProducoes",metadata:{ordemId:i.id,ordemCodigo:i.codigo,dias:c}})}}}catch(t){console.error("Erro ao verificar prazos das ordens:",t)}},Ws=async(s,a)=>{try{const t=new Date;t.setHours(0,0,0,0);const o=new Date(t);o.setDate(o.getDate()+7);const r=(await fe.getNotificationsByUser(a)).filter(i=>i.type==="pagamento_vencendo");for(const i of s)if(i.status==="pendente"||i.status==="atrasado"){const l=new Date(i.dataVencimento);if(l.setHours(0,0,0,0),l>=t&&l<=o&&!r.some(c=>c.metadata?.lancamentoId===i.id)){const c=ia(l,t);await fe.createNotification({userId:a,type:"pagamento_vencendo",title:"üí∞ Pagamento Vencendo",message:`${i.faccaoNome} - ${i.valor.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})} vence em ${c} dia(s)`,link:"financeiro",metadata:{lancamentoId:i.id,valor:i.valor,dias:c}})}if(l<t&&i.status==="atrasado"&&!r.some(c=>c.metadata?.lancamentoId===i.id&&c.title.includes("Vencido"))){const c=ia(t,l);await fe.createNotification({userId:a,type:"pagamento_vencendo",title:"üö® Pagamento Vencido",message:`${i.faccaoNome} - ${i.valor.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})} est√° ${c} dia(s) atrasado`,link:"financeiro",metadata:{lancamentoId:i.id,valor:i.valor,dias:c}})}}}catch(t){console.error("Erro ao verificar pagamentos:",t)}},Ys=async(s,a,t)=>{try{const o=new Date,r=(await fe.getNotificationsByUser(t)).filter(i=>i.type==="etapa_parada"&&!i.read);for(const i of s){const l=a.find(u=>u.id===i.ordemProducaoId);if(!(!l||l.status!=="em_producao")){for(const u of i.etapas)if(u.status==="pausada"&&u.dataInicio){const c=new Date(u.dataInicio),x=ia(c,o);x>3&&(r.some(v=>v.metadata?.ordemCodigo===l.codigo&&v.message.includes(u.etapaNome))||await fe.createNotification({userId:t,type:"etapa_parada",title:"‚è∏Ô∏è Etapa Parada",message:`${l.codigo} - Etapa "${u.etapaNome}" est√° parada h√° ${x} dia(s)`,link:"gestaoProducoes",metadata:{ordemId:l.id,ordemCodigo:l.codigo,dias:x}}))}}}}catch(o){console.error("Erro ao verificar etapas paradas:",o)}},Qs=async(s,a)=>{try{await Promise.all([Hs(a.orders,s),Ws(a.lancamentos,s),Ys(a.progressos,a.orders,s)])}catch(t){console.error("Erro ao executar verifica√ß√µes de notifica√ß√£o:",t)}};class Js{intervalId=null;isRunning=!1;userId=null;start(a,t=5){if(this.isRunning){console.log("Monitoramento de notifica√ß√µes j√° est√° em execu√ß√£o");return}this.userId=a,this.isRunning=!0,console.log(`üîî Iniciando monitoramento de notifica√ß√µes (intervalo: ${t}min)`),this.runChecks();const o=t*60*1e3;this.intervalId=setInterval(()=>{this.runChecks()},o)}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null),this.isRunning=!1,this.userId=null,console.log("üîï Monitoramento de notifica√ß√µes parado")}async runChecks(){if(!this.userId){console.error("UserId n√£o definido para monitoramento");return}try{console.log("üîç Executando verifica√ß√µes de notifica√ß√£o...");const[a,t]=await Promise.all([Pe.getOrders(this.userId),xe.getAllProgress(this.userId)]),[o,n]=await Promise.all([Ee.getLancamentosPendentes(this.userId),Ee.getLancamentosPagos(this.userId)]),r=[...o,...n];await Qs(this.userId,{orders:a,lancamentos:r,progressos:t}),console.log("‚úÖ Verifica√ß√µes de notifica√ß√£o conclu√≠das")}catch(a){console.error("‚ùå Erro ao executar verifica√ß√µes de notifica√ß√£o:",a)}}async forceCheck(){await this.runChecks()}isActive(){return this.isRunning}}const Ea=new Js,He={async createTask(s,a){try{const t=new Date;return{id:(await Ne(Q(D,"tasks"),{...a,completed:!1,userId:s,createdAt:ye.fromDate(t),updatedAt:ye.fromDate(t)})).id,...a,completed:!1,userId:s,createdAt:t,updatedAt:t}}catch(t){throw console.error("Erro ao criar tarefa:",t),new Error("Erro ao criar tarefa")}},async getTasksByUser(s){try{const a=ne(Q(D,"tasks"),te("userId","==",s)),t=await oe(a),o=[];return t.forEach(n=>{const r=n.data();o.push({id:n.id,description:r.description,time:r.time,priority:r.priority,completed:r.completed,userId:r.userId,createdAt:r.createdAt.toDate(),updatedAt:r.updatedAt.toDate()})}),o.sort((n,r)=>n.time.localeCompare(r.time))}catch(a){throw console.error("Erro ao buscar tarefas:",a),new Error("Erro ao buscar tarefas")}},async updateTask(s,a){try{const t=G(D,"tasks",s);await he(t,{...a,updatedAt:ye.fromDate(new Date)})}catch(t){throw console.error("Erro ao atualizar tarefa:",t),new Error("Erro ao atualizar tarefa")}},async deleteTask(s){try{await ue(G(D,"tasks",s))}catch(a){throw console.error("Erro ao deletar tarefa:",a),new Error("Erro ao deletar tarefa")}},async toggleTaskCompletion(s,a){try{const t=G(D,"tasks",s);await he(t,{completed:a,updatedAt:ye.fromDate(new Date)})}catch(t){throw console.error("Erro ao alterar status da tarefa:",t),new Error("Erro ao alterar status da tarefa")}},async deleteOldTasks(s){try{const a=new Date;a.setHours(0,0,0,0);const t=ne(Q(D,"tasks"),te("userId","==",s)),o=await oe(t),n=[];o.forEach(r=>{const l=r.data().createdAt.toDate();l.setHours(0,0,0,0),l.getTime()<a.getTime()&&n.push(ue(G(D,"tasks",r.id)))}),await Promise.all(n)}catch(a){throw console.error("Erro ao deletar tarefas antigas:",a),new Error("Erro ao deletar tarefas antigas")}}},Ks=({isOpen:s,onClose:a,onSubmit:t,isLoading:o=!1})=>{const[n,r]=d.useState({description:"",time:"",priority:"media"}),i=c=>{const{name:x,value:f}=c.target;r(v=>({...v,[x]:f}))},l=async c=>{if(c.preventDefault(),!n.description.trim()||!n.time){alert("Por favor, preencha todos os campos obrigat√≥rios");return}try{await t(n),r({description:"",time:"",priority:"media"}),a()}catch(x){console.error("Erro ao criar tarefa:",x)}},u=()=>{r({description:"",time:"",priority:"media"}),a()};return s?e.jsx("div",{className:"task-modal-overlay",onClick:u,children:e.jsxs("div",{className:"task-modal",onClick:c=>c.stopPropagation(),children:[e.jsxs("div",{className:"task-modal-header",children:[e.jsxs("div",{className:"task-modal-title-section",children:[e.jsx("h2",{className:"task-modal-title",children:"Nova Tarefa"}),e.jsx("p",{className:"task-modal-subtitle",children:"Adicione uma nova tarefa √† sua agenda"})]}),e.jsx("button",{className:"task-modal-close",onClick:u,children:e.jsx(pe,{size:20})})]}),e.jsxs("form",{className:"task-modal-form",onSubmit:l,children:[e.jsxs("div",{className:"task-modal-field",children:[e.jsx("label",{className:"task-modal-label",htmlFor:"description",children:"Descri√ß√£o da Tarefa"}),e.jsx("input",{id:"description",name:"description",type:"text",value:n.description,onChange:i,placeholder:"Digite a descri√ß√£o da tarefa",className:"task-modal-input",required:!0})]}),e.jsxs("div",{className:"task-modal-field",children:[e.jsx("label",{className:"task-modal-label",htmlFor:"time",children:"Hor√°rio"}),e.jsxs("div",{className:"task-modal-time-container",children:[e.jsx("input",{id:"time",name:"time",type:"time",value:n.time,onChange:i,className:"task-modal-input task-modal-time-input",required:!0}),e.jsx(Fe,{className:"task-modal-time-icon",size:16})]})]}),e.jsxs("div",{className:"task-modal-field",children:[e.jsx("label",{className:"task-modal-label",htmlFor:"priority",children:"Prioridade"}),e.jsxs("select",{id:"priority",name:"priority",value:n.priority,onChange:i,className:"task-modal-select",children:[e.jsx("option",{value:"baixa",children:"Baixa"}),e.jsx("option",{value:"media",children:"M√©dia"}),e.jsx("option",{value:"alta",children:"Alta"})]})]}),e.jsxs("div",{className:"task-modal-actions",children:[e.jsx(Ue,{type:"button",variant:"outline",onClick:u,disabled:o,children:"Cancelar"}),e.jsx(Ue,{type:"submit",variant:"primary",isLoading:o,disabled:!n.description.trim()||!n.time,children:"Adicionar"})]})]})]})}):null},Xs=()=>{const{user:s}=le(),[a,t]=d.useState([]),[o,n]=d.useState(!1),[r,i]=d.useState(!1),[l,u]=d.useState(!0),c=d.useCallback(async()=>{if(s)try{u(!0);const g=await He.getTasksByUser(s.uid),N=new Date;N.setHours(0,0,0,0);const C=new Date;C.setDate(C.getDate()+1);const q=g.filter(F=>{const _=new Date(F.createdAt);return _.setHours(0,0,0,0),_.getTime()===N.getTime()});t(q),await He.deleteOldTasks(s.uid)}catch(g){console.error("Erro ao carregar tarefas:",g)}finally{u(!1)}},[s]);d.useEffect(()=>{c()},[c]);const x=async g=>{if(s)try{i(!0),await He.createTask(s.uid,g),await c()}catch(N){throw console.error("Erro ao criar tarefa:",N),N}finally{i(!1)}},f=async(g,N)=>{try{await He.toggleTaskCompletion(g,N),await c()}catch(C){console.error("Erro ao alterar status da tarefa:",C)}},v=async g=>{if(confirm("Tem certeza que deseja excluir esta tarefa?"))try{await He.deleteTask(g),await c()}catch(N){console.error("Erro ao excluir tarefa:",N)}},p=g=>{switch(g){case"alta":return"task-priority-high";case"media":return"task-priority-medium";case"baixa":return"task-priority-low";default:return"task-priority-medium"}},m=g=>{switch(g){case"alta":return"Alta";case"media":return"M√©dia";case"baixa":return"Baixa";default:return"M√©dia"}};return e.jsxs("div",{className:"agenda-card",children:[e.jsxs("div",{className:"agenda-header",children:[e.jsxs("div",{className:"agenda-title-section",children:[e.jsxs("div",{className:"agenda-title",children:[e.jsx(Fe,{className:"agenda-icon",size:20}),e.jsx("h3",{children:"Agenda do Dia"})]}),e.jsx("p",{className:"agenda-subtitle",children:"Suas tarefas e compromissos de hoje"})]}),e.jsx("button",{className:"agenda-add-button",onClick:()=>n(!0),children:e.jsx(ke,{className:"agenda-add-icon",size:20})})]}),e.jsx("div",{className:"agenda-content",children:l?e.jsx("div",{className:"agenda-loading",children:e.jsx("p",{children:"Carregando tarefas..."})}):a.length===0?e.jsxs("div",{className:"agenda-empty",children:[e.jsx("p",{children:"Nenhuma tarefa cadastrada"}),e.jsx("p",{className:"agenda-empty-subtitle",children:"Clique no bot√£o + para adicionar uma nova tarefa"})]}):e.jsx("div",{className:"agenda-tasks",children:a.map(g=>e.jsx("div",{className:`agenda-task ${g.completed?"task-completed":""}`,children:e.jsxs("div",{className:"task-content",children:[e.jsxs("div",{className:"task-main",children:[e.jsx("h4",{className:"task-description",children:g.description}),e.jsxs("div",{className:"task-meta",children:[e.jsx("span",{className:`task-priority ${p(g.priority)}`,children:m(g.priority)}),e.jsx("span",{className:"task-time",children:g.time})]})]}),e.jsxs("div",{className:"task-actions",children:[e.jsx("button",{className:`task-action task-complete ${g.completed?"task-completed-icon":""}`,onClick:()=>f(g.id,!g.completed),title:g.completed?"Marcar como pendente":"Marcar como conclu√≠da",children:e.jsx(ce,{size:14})}),e.jsx("button",{className:"task-action task-edit",title:"Editar tarefa",children:e.jsx(Aa,{size:14})}),e.jsx("button",{className:"task-action task-delete",onClick:()=>v(g.id),title:"Excluir tarefa",children:e.jsx(Le,{size:14})})]})]})},g.id))})}),e.jsx(Ks,{isOpen:o,onClose:()=>n(!1),onSubmit:x,isLoading:r})]})},Pa=()=>{const{user:s}=le(),[a,t]=d.useState([]),[o,n]=d.useState([]),[r,i]=d.useState([]),[l,u]=d.useState([]),[c,x]=d.useState([]),[f,v]=d.useState(!0);d.useEffect(()=>((async()=>{if(s)try{v(!0);const[C,q,F,_,M]=await Promise.all([Pe.getOrders(s.uid),we.getProdutos(s.uid),Ce.getFaccoes(),xe.getAllProgress(s.uid),Ee.getLancamentosPendentes(s.uid)]);t(C),n(q),i(F),u(_),x(M),Ea.isActive()||Ea.start(s.uid,5)}catch(C){console.error("Erro ao carregar dados:",C)}finally{v(!1)}})(),()=>{}),[s]);const p=N=>{const C=l.find(L=>L.ordemProducaoId===N);if(!C)return{etapa:"Planejamento",status:"N√£o iniciada"};const q=C.etapas.find(L=>L.status==="em_andamento");if(q)return{etapa:q.etapaNome,status:"Em andamento"};const F=C.etapas.find(L=>L.status==="pausada");if(F)return{etapa:F.etapaNome,status:"Pausada"};if(C.etapas.every(L=>L.status==="finalizada")&&C.etapas.length>0)return{etapa:C.etapas[C.etapas.length-1].etapaNome,status:"Finalizada"};const M=[...C.etapas].reverse().find(L=>L.status==="finalizada");return M?{etapa:M.etapaNome,status:"Aguardando pr√≥xima"}:{etapa:"Planejamento",status:"N√£o iniciada"}},m=[...a].sort((N,C)=>C.createdAt.getTime()-N.createdAt.getTime()).slice(0,4),g=c.filter(N=>N.status==="pendente"||N.status==="atrasado").reduce((N,C)=>N+C.valor,0);return f?e.jsx("div",{className:"tab-content",children:e.jsxs("div",{className:"tab-header",children:[e.jsx("h2",{className:"tab-title",children:"Dashboard"}),e.jsx("p",{className:"tab-subtitle",children:"Carregando dados..."})]})}):e.jsxs("div",{className:"tab-content",children:[e.jsxs("div",{className:"tab-header",children:[e.jsx("h2",{className:"tab-title",children:"Dashboard"}),e.jsx("p",{className:"tab-subtitle",children:"Vis√£o geral do sistema de gest√£o de produ√ß√£o t√™xtil"})]}),e.jsxs("div",{className:"dashboard-grid",children:[e.jsxs("div",{className:"dashboard-card",children:[e.jsxs("div",{className:"card-header",children:[e.jsxs("div",{className:"card-info",children:[e.jsx("h3",{className:"card-title",children:"Ordens Ativas"}),e.jsx("span",{className:"card-value",children:a.length}),e.jsx("p",{className:"card-subtitle",children:"Em produ√ß√£o"})]}),e.jsx("div",{className:"card-icon purple",children:e.jsx(Ya,{size:16})})]}),e.jsx("div",{className:"card-footer",children:e.jsxs("span",{className:"card-trend positive",children:[e.jsx(Be,{size:12}),"+12%"]})})]}),e.jsxs("div",{className:"dashboard-card",children:[e.jsxs("div",{className:"card-header",children:[e.jsxs("div",{className:"card-info",children:[e.jsx("h3",{className:"card-title",children:"Produtos Cadastrados"}),e.jsx("span",{className:"card-value",children:o.length}),e.jsx("p",{className:"card-subtitle",children:"Total de refer√™ncias"})]}),e.jsx("div",{className:"card-icon blue",children:e.jsx(ze,{size:16})})]}),e.jsx("div",{className:"card-footer",children:e.jsxs("span",{className:"card-trend positive",children:[e.jsx(Be,{size:12}),"+8%"]})})]}),e.jsxs("div",{className:"dashboard-card",children:[e.jsxs("div",{className:"card-header",children:[e.jsxs("div",{className:"card-info",children:[e.jsx("h3",{className:"card-title",children:"Fac√ß√µes Ativas"}),e.jsx("span",{className:"card-value",children:r.length}),e.jsx("p",{className:"card-subtitle",children:"Tercerizados"})]}),e.jsx("div",{className:"card-icon green",children:e.jsx(Oe,{size:16})})]}),e.jsx("div",{className:"card-footer",children:e.jsxs("span",{className:"card-trend positive",children:[e.jsx(Be,{size:12}),"+2"]})})]}),e.jsxs("div",{className:"dashboard-card",children:[e.jsxs("div",{className:"card-header",children:[e.jsxs("div",{className:"card-info",children:[e.jsx("h3",{className:"card-title",children:"Pend√™ncias Financeiras"}),e.jsx("span",{className:"card-value",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(g)}),e.jsx("p",{className:"card-subtitle",children:"A pagar"})]}),e.jsx("div",{className:"card-icon yellow",children:e.jsx(ca,{size:16})})]}),e.jsx("div",{className:"card-footer",children:e.jsxs("span",{className:"card-trend negative",children:[e.jsx(Qa,{size:12}),c.length," lan√ßamentos"]})})]}),e.jsx(Xs,{})]}),e.jsxs("div",{className:"recent-orders-section",children:[e.jsx("div",{className:"recent-orders-header",children:e.jsxs("div",{className:"recent-orders-title-wrapper",children:[e.jsx(fa,{size:24,className:"recent-orders-icon"}),e.jsxs("div",{children:[e.jsx("h2",{className:"recent-orders-title",children:"Ordens de Produ√ß√£o Recentes"}),e.jsx("p",{className:"recent-orders-subtitle",children:"Acompanhe o status das suas ordens em tempo real"})]})]})}),e.jsx("div",{className:"recent-orders-list",children:m.length===0?e.jsx("div",{className:"no-orders",children:e.jsx("p",{children:"Nenhuma ordem de produ√ß√£o cadastrada ainda."})}):m.map(N=>{const{etapa:C,status:q}=p(N.id);return e.jsxs("div",{className:"order-item",children:[e.jsxs("div",{className:"order-item-header",children:[e.jsxs("div",{className:"order-item-left",children:[e.jsx("span",{className:"order-code",children:N.codigo}),e.jsx("h3",{className:"order-product",children:N.produtoDescricao}),e.jsx("span",{className:`order-priority-badge ${N.prioridade}`,children:N.prioridade})]}),e.jsx("button",{className:"order-details-btn",onClick:()=>{const F=document.querySelectorAll(".tab-button"),_=Array.from(F).find(M=>M.textContent?.includes("Gest√£o de Produ√ß√µes"));_&&_.click()},children:"Ver Detalhes"})]}),e.jsxs("div",{className:"order-item-footer",children:[e.jsxs("span",{className:"order-stage",children:["Etapa: ",C]}),e.jsx("span",{className:"order-status-dot",children:"‚Ä¢"}),e.jsx("span",{className:"order-status",children:q})]})]},N.id)})})]})]})},De={async getStepsCount(){try{return(await oe(Q(D,"productionSteps"))).size}catch(s){throw console.error("Erro ao buscar etapas:",s),new Error("Erro ao buscar etapas")}},async getAllSteps(){try{const s=ne(Q(D,"productionSteps"),ge("order","asc")),a=await oe(s),t=[];return a.forEach(o=>{const n=o.data();t.push({id:o.id,name:n.name,description:n.description,order:n.order,userId:n.userId,createdAt:n.createdAt.toDate(),updatedAt:n.updatedAt.toDate()})}),t}catch(s){throw console.error("Erro ao buscar etapas:",s),new Error("Erro ao buscar etapas")}},async createStep(s,a){try{const t=new Date;return{id:(await Ne(Q(D,"productionSteps"),{...a,userId:s,createdAt:ye.fromDate(t),updatedAt:ye.fromDate(t)})).id,...a,userId:s,createdAt:t,updatedAt:t}}catch(t){throw console.error("Erro ao criar etapa:",t),new Error("Erro ao criar etapa")}},async getStepsByUser(s){try{const a=ne(Q(D,"productionSteps"),te("userId","==",s)),t=await oe(a),o=[];return t.forEach(n=>{const r=n.data();o.push({id:n.id,name:r.name,description:r.description,order:r.order,userId:r.userId,createdAt:r.createdAt.toDate(),updatedAt:r.updatedAt.toDate()})}),o.sort((n,r)=>n.order-r.order)}catch(a){throw console.error("Erro ao buscar etapas:",a),new Error("Erro ao buscar etapas")}},async updateStep(s,a){try{const t=G(D,"productionSteps",s);await he(t,{...a,updatedAt:ye.fromDate(new Date)})}catch(t){throw console.error("Erro ao atualizar etapa:",t),new Error("Erro ao atualizar etapa")}},async deleteStep(s){try{await ue(G(D,"productionSteps",s))}catch(a){throw console.error("Erro ao deletar etapa:",a),new Error("Erro ao deletar etapa")}}},Zs=()=>{const[s,a]=d.useState(!1),[t,o]=d.useState(!0),[n,r]=d.useState(!1),[i,l]=d.useState(null),[u,c]=d.useState({nome:"",endereco:"",logoUrl:""});d.useEffect(()=>{x()},[]);const x=async()=>{try{o(!0);const m=await ra.getCompanyInfo();m&&c(m)}catch(m){console.error("Erro ao carregar informa√ß√µes:",m),l({type:"error",text:"Erro ao carregar informa√ß√µes da empresa"})}finally{o(!1)}},f=m=>{const{name:g,value:N}=m.target;c(C=>({...C,[g]:N}))},v=async m=>{const g=m.target.files?.[0];if(g){if(!g.type.startsWith("image/")){l({type:"error",text:"Por favor, selecione uma imagem v√°lida"});return}if(g.size>5*1024*1024){l({type:"error",text:"A imagem deve ter no m√°ximo 5MB"});return}try{r(!0);const N=await ra.uploadLogo(g);c(C=>({...C,logoUrl:N})),l({type:"success",text:"Logo enviada com sucesso!"})}catch(N){console.error("Erro ao fazer upload:",N),l({type:"error",text:"Erro ao fazer upload da logo"})}finally{r(!1)}}},p=async m=>{if(m.preventDefault(),!u.nome.trim()){l({type:"error",text:"O nome da empresa √© obrigat√≥rio"});return}try{a(!0),l(null),await ra.saveCompanyInfo({nome:u.nome,endereco:u.endereco,logoUrl:u.logoUrl}),l({type:"success",text:"Informa√ß√µes salvas com sucesso!"}),window.dispatchEvent(new CustomEvent("companyInfoUpdated"))}catch(g){console.error("Erro ao salvar:",g),l({type:"error",text:"Erro ao salvar informa√ß√µes"})}finally{a(!1)}};return t?e.jsxs("div",{className:"company-form-loading",children:[e.jsx(ma,{className:"loading-spinner",size:32}),e.jsx("p",{children:"Carregando informa√ß√µes..."})]}):e.jsxs("div",{className:"company-form-container",children:[e.jsxs("div",{className:"company-form-header",children:[e.jsx(ua,{size:32}),e.jsxs("div",{children:[e.jsx("h2",{children:"Informa√ß√µes da Empresa"}),e.jsx("p",{children:"Configure o nome, logo e endere√ßo da sua empresa"})]})]}),e.jsxs("form",{onSubmit:p,className:"company-form",children:[e.jsxs("div",{className:"form-group logo-section",children:[e.jsx("label",{className:"form-label",children:"Logomarca"}),e.jsxs("div",{className:"logo-upload-area",children:[u.logoUrl&&e.jsx("div",{className:"logo-preview",children:e.jsx("img",{src:u.logoUrl,alt:"Logo da empresa"})}),e.jsxs("label",{className:"logo-upload-btn",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:v,disabled:n}),n?e.jsxs(e.Fragment,{children:[e.jsx(ma,{className:"upload-icon spinning",size:20}),e.jsx("span",{children:"Enviando..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ja,{className:"upload-icon",size:20}),e.jsx("span",{children:u.logoUrl?"Alterar Logo":"Enviar Logo"})]})]}),e.jsx("p",{className:"logo-upload-hint",children:"Formatos aceitos: JPG, PNG, GIF (m√°x. 5MB)"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"nome",className:"form-label",children:[e.jsx(ua,{size:18}),"Nome da Empresa *"]}),e.jsx("input",{type:"text",id:"nome",name:"nome",value:u.nome,onChange:f,placeholder:"Digite o nome da empresa",className:"form-input",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"endereco",className:"form-label",children:[e.jsx(Ta,{size:18}),"Endere√ßo Completo"]}),e.jsx("textarea",{id:"endereco",name:"endereco",value:u.endereco,onChange:f,placeholder:"Rua, N√∫mero, Bairro, Cidade - Estado, CEP",className:"form-textarea",rows:3})]}),i&&e.jsx("div",{className:`form-message ${i.type}`,children:i.text}),e.jsx("button",{type:"submit",className:"form-submit-btn",disabled:s||n,children:s?e.jsxs(e.Fragment,{children:[e.jsx(ma,{className:"btn-icon spinning",size:20}),"Salvando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ka,{className:"btn-icon",size:20}),"Salvar Informa√ß√µes"]})})]})]})},et=({onTabChange:s})=>{const[a,t]=ta.useState(!1),{user:o}=le(),[n,r]=d.useState(0),[i,l]=d.useState(0),[u,c]=d.useState(0),[x,f]=d.useState(!0);return d.useEffect(()=>{(async()=>{if(o)try{const[p,m,g]=await Promise.all([we.getProdutos(o.uid),Ce.getFaccoes(),De.getStepsCount()]);r(p.length),l(m.length),c(g)}catch(p){console.error("Erro ao buscar dados:",p)}finally{f(!1)}})()},[o]),e.jsxs("div",{className:"cadastros-container",children:[e.jsxs("div",{className:"cadastros-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h2",{className:"section-title",children:"Informa√ß√µes da Empresa"}),e.jsx("p",{className:"section-description",children:"Configure o nome, logomarca e endere√ßo da sua empresa"})]}),a?e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx("button",{onClick:()=>t(!1),style:{marginBottom:"1rem",padding:"0.5rem 1rem",background:"#e5e7eb",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"0.875rem"},children:"‚Üê Voltar"}),e.jsx(Zs,{})]}):e.jsx("div",{className:"cards-container",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-icon",children:e.jsx(ua,{size:24,color:"#1e3a8a"})}),e.jsxs("div",{className:"card-content",children:[e.jsx("h3",{className:"card-title",children:"Dados da Empresa"}),e.jsx("p",{className:"card-description",children:"Configure nome, logo e endere√ßo"})]}),e.jsx("button",{onClick:()=>t(!0),className:"card-button",children:"Configurar"})]})})]}),!a&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"cadastros-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h2",{className:"section-title",children:"Cadastros"}),e.jsx("p",{className:"section-description",children:"Gerencie todas informa√ß√µes b√°sicas do sistema"})]}),e.jsxs("div",{className:"cards-container",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-icon",children:e.jsx(Oe,{size:24,color:"#1e3a8a"})}),e.jsxs("div",{className:"card-content",children:[e.jsx("h3",{className:"card-title",children:"Fac√ß√µes / Terceirizados"}),e.jsx("p",{className:"card-description",children:"Gerencie seus parceiros de produ√ß√£o"}),e.jsxs("span",{className:"card-count",children:[x?"...":`${i} cadastrado${i===1?"":"s"}`," "]})]}),e.jsx("button",{onClick:()=>{s("faccoes")},className:"card-button",children:"Acessar"})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-icon",children:e.jsx(ba,{size:24,color:"#1e3a8a"})}),e.jsxs("div",{className:"card-content",children:[e.jsx("h3",{className:"card-title",children:"Etapas de Produ√ß√£o"}),e.jsx("p",{className:"card-description",children:"Configure as etapas do processo produtivo"}),e.jsx("span",{className:"card-count",children:x?"...":`${u} etapa${u===1?"":"s"}`})]}),e.jsx("button",{onClick:()=>{s("etapas")},className:"card-button",children:"Acessar"})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-icon",children:e.jsx(ze,{size:24,color:"#1e3a8a"})}),e.jsxs("div",{className:"card-content",children:[e.jsx("h3",{className:"card-title",children:"Produtos"}),e.jsx("p",{className:"card-description",children:"Cat√°logo de produtos e especifica√ß√µes"}),e.jsx("span",{className:"card-count",children:x?"...":`${n} produto${n===1?"":"s"}`})]}),e.jsx("button",{onClick:()=>{s("produto")},className:"card-button",children:"Acessar"})]})]})]}),e.jsxs("div",{className:"acoes-rapidas-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h2",{className:"section-title",children:"A√ß√µes R√°pidas"}),e.jsx("p",{className:"section-description",children:"Cadastre rapidamente novos itens no sistema"})]}),e.jsxs("div",{className:"botoes-container",children:[e.jsxs("button",{className:"acao-rapida-btn",onClick:()=>{s("faccoes")},children:[e.jsx(Oe,{size:20}),e.jsx("span",{children:" + Nova Fac√ß√£o"})]}),e.jsxs("button",{className:"acao-rapida-btn",onClick:()=>{s("etapas")},children:[e.jsx(ba,{size:20}),e.jsx("span",{children:" + Nova Etapa"})]}),e.jsxs("button",{className:"acao-rapida-btn",onClick:()=>{s("produto")},children:[e.jsx(ze,{size:20}),e.jsx("span",{children:" + Novo Produto"})]})]})]})]})]})},at=({isOpen:s,onClose:a,onSave:t,faccaoToEdit:o})=>{const{user:n}=le(),[r,i]=d.useState({nome:"",servicoPrestado:"",enderecoCompleto:"",telefone:"",email:"",ativo:!0}),[l,u]=d.useState(!1),[c,x]=d.useState(null),[f,v]=d.useState([]);d.useEffect(()=>{const m=async()=>{try{const g=await De.getStepsByUser(n.uid);v(g)}catch(g){console.error("Erro ao buscar etapas:",g)}s&&m()};m()},[s,n]),d.useEffect(()=>{i(o?{nome:o.nome,servicoPrestado:o.servicoPrestado,enderecoCompleto:o.enderecoCompleto,telefone:o.telefone,email:o.email,ativo:o.ativo}:{nome:"",servicoPrestado:"",enderecoCompleto:"",telefone:"",email:"",ativo:!0}),x(null)},[o,s]);const p=async m=>{if(m.preventDefault(),x(null),!r.nome.trim()){x("Nome √© obrigat√≥rio");return}try{u(!0),await t(r),a()}catch(g){console.error("Erro ao salvar fac√ß√£o:",g),x("Erro ao salvar fac√ß√£o. Tente novamente.")}finally{u(!1)}};return s?e.jsx("div",{className:"faccao-modal-overlay",onClick:a,children:e.jsxs("div",{className:"faccao-modal",onClick:m=>m.stopPropagation(),children:[e.jsxs("div",{className:"faccao-modal-header",children:[e.jsxs("div",{className:"faccao-modal-title-section",children:[e.jsx("h2",{className:"faccao-modal-title",children:o?"Editar Fac√ß√£o":"Cadastrar Nova Fac√ß√£o"}),e.jsx("p",{className:"faccao-modal-subtitle",children:o?"Atualize as informa√ß√µes do parceiro de produ√ß√£o":"Adicione um novo parceiro de produ√ß√£o ao sistema"})]}),e.jsx("button",{className:"faccao-modal-close",onClick:a,type:"button",children:e.jsx(pe,{size:24})})]}),e.jsxs("form",{onSubmit:p,className:"faccao-modal-form",children:[e.jsxs("div",{className:"faccao-modal-row",children:[e.jsxs("div",{className:"faccao-modal-field",children:[e.jsx("label",{htmlFor:"nome",className:"faccao-modal-label",children:"Nome *"}),e.jsx("input",{type:"text",id:"nome",className:"faccao-modal-input",placeholder:"Nome da fac√ß√£o",value:r.nome,onChange:m=>i({...r,nome:m.target.value}),required:!0})]}),e.jsxs("div",{className:"faccao-modal-field",children:[e.jsx("label",{htmlFor:"servico",className:"faccao-modal-label",children:"Servi√ßo Prestado *"}),e.jsx("select",{id:"servico",className:"faccao-modal-select",value:r.servicoPrestado,onChange:m=>i({...r,servicoPrestado:m.target.value}),required:!0,children:f.length===0?e.jsx("option",{value:"",children:"Nenhuma etapa encontrada"}):f.map(m=>e.jsx("option",{value:m.name,children:m.name},m.id))})]})]}),e.jsxs("div",{className:"faccao-modal-field",children:[e.jsx("label",{htmlFor:"endereco",className:"faccao-modal-label",children:"Endere√ßo Completo *"}),e.jsx("textarea",{id:"endereco",className:"faccao-modal-textarea",placeholder:"Rua, n√∫mero, bairro, cidade, estado, CEP",value:r.enderecoCompleto,onChange:m=>i({...r,enderecoCompleto:m.target.value}),rows:3,required:!0})]}),e.jsxs("div",{className:"faccao-modal-row",children:[e.jsxs("div",{className:"faccao-modal-field",children:[e.jsx("label",{htmlFor:"telefone",className:"faccao-modal-label",children:"Telefone"}),e.jsx("input",{type:"tel",id:"telefone",className:"faccao-modal-input",placeholder:"(11) 99999-9999",value:r.telefone,onChange:m=>i({...r,telefone:La(m.target.value)}),maxLength:15})]}),e.jsxs("div",{className:"faccao-modal-field",children:[e.jsx("label",{htmlFor:"email",className:"faccao-modal-label",children:"E-mail"}),e.jsx("input",{type:"email",id:"email",className:"faccao-modal-input",placeholder:"contato@faccao.com",value:r.email,onChange:m=>i({...r,email:m.target.value})})]})]}),c&&e.jsx("div",{className:"faccao-modal-error",children:c}),e.jsxs("div",{className:"faccao-modal-actions",children:[e.jsx("button",{type:"button",className:"faccao-btn-cancel",onClick:a,disabled:l,children:"Cancelar"}),e.jsx("button",{type:"submit",className:"faccao-btn-save",disabled:l,children:l?"Salvando...":"Salvar Fac√ß√£o"})]})]})]})}):null},Qe=({isOpen:s,onClose:a,onConfirm:t,title:o,message:n,itemName:r,confirmText:i,cancelText:l,loading:u})=>{if(!s)return null;const c=async()=>{await t()};return e.jsx("div",{className:"delete-modal-overlay",onClick:a,children:e.jsxs("div",{className:"delete-modal",onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"delete-modal-header",children:[e.jsx("div",{className:"delete-modal-icon-wrapper",children:e.jsx(Fa,{size:24,className:"delete-modal-icon"})}),e.jsx("button",{className:"delete-modal-close",onClick:a,type:"button",disabled:u,children:e.jsx(pe,{size:24})})]}),e.jsxs("div",{className:"delete-modal-content",children:[e.jsx("h2",{className:"delete-modal-title",children:o||"Confirmar Exclus√£o"}),e.jsxs("p",{className:"delete-modal-message",children:[n,r&&e.jsxs("span",{className:"delete-modal-item-name",children:['"',r,'"']}),"?"]}),e.jsx("p",{className:"delete-modal-warning",children:"Esta a√ß√£o n√£o pode ser desfeita."})]}),e.jsxs("div",{className:"delete-modal-actions",children:[e.jsx("button",{type:"button",className:"delete-btn-cancel",onClick:a,disabled:u,children:l||"Cancelar"}),e.jsx("button",{className:"delete-btn-confirm",onClick:c,disabled:u,type:"button",children:u?"Excluindo...":i})]})]})})},st=()=>{const[s,a]=d.useState([]),[t,o]=d.useState([]),[n,r]=d.useState(!0),[i,l]=d.useState(""),[u,c]=d.useState(!1),[x,f]=d.useState(null),[v,p]=d.useState(!1),[m,g]=d.useState(null),[N,C]=d.useState(!1),q=S=>{g(S),p(!0)},F=async()=>{if(m)try{C(!0),await Ce.deleteFaccao(m),await _(),p(!1),g(null),W.success("Fac√ß√£o exclu√≠da com sucesso!",{icon:e.jsx(ce,{size:20})})}catch(S){console.error("Erro ao deletar fac√ß√£o:",S),W.error("Erro ao deletar fac√ß√£o. Tente novamente.")}finally{C(!1)}};d.useEffect(()=>{_()},[]),d.useEffect(()=>{if(i.trim()==="")o(s);else{const S=s.filter($=>$.nome.toLowerCase().includes(i.toLowerCase())||$.servicoPrestado.toLowerCase().includes(i.toLowerCase()));o(S)}},[i,s]);const _=async()=>{try{r(!0);const S=await Ce.getFaccoes();a(S),o(S)}catch(S){console.error("Erro ao carregar fac√ß√µes:",S)}finally{r(!1)}},M=async S=>{try{x?.id?(await Ce.updateFaccao(x.id,S),W.success("Fac√ß√£o atualizada com sucesso!",{icon:e.jsx(ce,{size:20})})):(await Ce.createFaccao(S),W.success("Fac√ß√£o criada com sucesso!",{icon:e.jsx(ce,{size:20})})),await _(),c(!1),f(null)}catch($){console.error("Erro ao salvar fac√ß√£o:",$);const ie=$ instanceof Error?$.message:"Erro ao salvar fac√ß√£o. Tente novamente.";throw W.error(ie),$}},L=S=>{f(S),c(!0)},E=()=>{f(null),c(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"header-container",children:[e.jsx("h2",{className:"header-title-faccoes",children:"Fac√ß√µes / Terceirizados"}),e.jsx("p",{className:"header-subtitle-faccoes",children:"Gerencie seus parceiros de produ√ß√£o"})]}),e.jsxs("div",{className:"faccoes-container",children:[e.jsxs("div",{className:"faccoes-header",children:[e.jsxs("div",{className:"faccoes-title-section",children:[e.jsx("h1",{className:"faccoes-title",children:"Fac√ß√µes / Terceirizados"}),e.jsx("p",{className:"faccoes-subtitle",children:"Gerencie seus parceiros de produ√ß√£o"})]}),e.jsxs("button",{className:"faccoes-add-button",onClick:E,children:[e.jsx("span",{className:"faccoes-add-icon",children:"+"}),e.jsx("span",{className:"faccoes-add-text",children:"Nova Fac√ß√£o"})]})]}),e.jsx("div",{className:"faccoes-search-container",children:e.jsxs("div",{className:"faccoes-search-box",children:[e.jsx(_e,{size:20,className:"faccoes-search-icon"}),e.jsx("input",{type:"text",className:"faccoes-search-input",placeholder:"Buscar por nome ou servi√ßo...",value:i,onChange:S=>l(S.target.value)})]})}),e.jsx("div",{className:"faccoes-content",children:n?e.jsx("div",{className:"faccoes-loading",children:e.jsx("p",{children:"Carregando fac√ß√µes..."})}):t.length===0?e.jsxs("div",{className:"faccoes-empty",children:[e.jsx(Oe,{size:48}),e.jsx("p",{children:i?"Nenhuma fac√ß√£o encontrada com esse termo":"Nenhuma fac√ß√£o cadastrada"}),!i&&e.jsx("p",{className:"faccoes-empty-subtitle",children:'Clique em "Nova Fac√ß√£o" para adicionar um parceiro'})]}):e.jsx("div",{className:"faccoes-grid",children:t.map(S=>e.jsxs("div",{className:"faccao-card",children:[e.jsxs("div",{className:"faccao-card-header",children:[e.jsx("div",{className:"faccao-avatar",children:e.jsx(Oe,{size:24})}),e.jsxs("div",{className:"faccao-header-info",children:[e.jsx("h3",{className:"faccao-name",children:S.nome}),S.ativo&&e.jsx("span",{className:"faccao-status",children:"Ativo"})]}),e.jsxs("div",{className:"faccao-actions",children:[e.jsx("button",{className:"faccao-action-btn faccao-edit-btn",onClick:()=>L(S),title:"Editar",children:e.jsx(Xa,{size:16})}),e.jsx("button",{className:"faccao-action-btn faccao-delete-btn",onClick:()=>S.id&&q(S.id),title:"Excluir",children:e.jsx(Le,{size:16})})]})]}),e.jsxs("div",{className:"faccao-card-body",children:[e.jsxs("div",{className:"faccao-info-row",children:[e.jsx(Ta,{size:16,className:"faccao-icon"}),e.jsx("span",{className:"faccao-info-text",children:S.enderecoCompleto})]}),e.jsxs("div",{className:"faccao-servicos",children:[e.jsx("span",{className:"faccao-servicos-label",children:"Servi√ßo:"}),e.jsx("span",{className:"faccao-servico-tag",children:S.servicoPrestado})]}),e.jsxs("div",{className:"faccao-contact",children:[S.telefone&&e.jsxs("div",{className:"faccao-contact-item",children:[e.jsx(Za,{size:14,className:"faccao-contact-icon"}),e.jsxs("span",{children:["Telefone: ",S.telefone]})]}),S.email&&e.jsxs("div",{className:"faccao-contact-item",children:[e.jsx(es,{size:14,className:"faccao-contact-icon"}),e.jsxs("span",{children:["E-mail: ",S.email]})]})]})]})]},S.id))})}),e.jsx(at,{isOpen:u,onClose:()=>{c(!1),f(null)},onSave:M,faccaoToEdit:x}),e.jsx(Qe,{isOpen:v,onClose:()=>{p(!1),g(null)},onConfirm:F,itemName:s.find(S=>S.id===m)?.nome||"",loading:N,title:"Confirmar Exclus√£o",message:"Tem certeza que deseja excluir esta fac√ß√£o?",confirmText:"Excluir",cancelText:"Cancelar"})]})]})},tt=({isOpen:s,onClose:a,onSubmit:t,stepToEdit:o,isLoading:n=!1})=>{const[r,i]=d.useState({name:"",description:"",order:0});d.useEffect(()=>{i(o?{name:o.name,description:o.description,order:o.order}:{name:"",description:"",order:0})},[o,s]);const l=x=>{const{name:f,value:v}=x.target;i(p=>({...p,[f]:f==="order"?parseInt(v)||0:v}))},u=async x=>{if(x.preventDefault(),!r.name.trim()||!r.description.trim()){alert("Por favor, preencha todos os campos obrigat√≥rios");return}try{await t(r),i({name:"",description:"",order:0}),a()}catch(f){console.error("Erro ao salvar etapa:",f)}},c=()=>{i({name:"",description:"",order:0}),a()};return s?e.jsx("div",{className:"step-modal-overlay",onClick:c,children:e.jsxs("div",{className:"step-modal",onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"step-modal-header",children:[e.jsxs("div",{className:"step-modal-title-section",children:[e.jsx("h2",{className:"step-modal-title",children:o?"Editar Etapa":"Nova Etapa"}),e.jsx("p",{className:"step-modal-subtitle",children:o?"Atualize as informa√ß√µes da etapa":"Configure uma etapa do processo produtivo"})]}),e.jsx("button",{className:"step-modal-close",onClick:c,children:e.jsx(pe,{size:20})})]}),e.jsxs("form",{className:"step-modal-form",onSubmit:u,children:[e.jsxs("div",{className:"step-modal-field",children:[e.jsx("label",{className:"step-modal-label",htmlFor:"name",children:"Nome da Etapa"}),e.jsx("input",{id:"name",name:"name",type:"text",value:r.name,onChange:l,placeholder:"Ex: Corte, Costura, Silk...",className:"step-modal-input",required:!0})]}),e.jsxs("div",{className:"step-modal-field",children:[e.jsx("label",{className:"step-modal-label",htmlFor:"description",children:"Descri√ß√£o"}),e.jsx("textarea",{id:"description",name:"description",value:r.description,onChange:l,placeholder:"Descreva o que √© feito nesta etapa",className:"step-modal-textarea",rows:4,required:!0})]}),e.jsxs("div",{className:"step-modal-field",children:[e.jsx("label",{className:"step-modal-label",htmlFor:"order",children:"Ordem de Execu√ß√£o"}),e.jsx("input",{id:"order",name:"order",type:"number",min:"0",value:r.order,onChange:l,className:"step-modal-input",required:!0})]}),e.jsxs("div",{className:"step-modal-actions",children:[e.jsx(Ue,{type:"button",variant:"outline",onClick:c,disabled:n,children:"Cancelar"}),e.jsx(Ue,{type:"submit",variant:"primary",isLoading:n,disabled:!r.name.trim()||!r.description.trim(),children:o?"Salvar Altera√ß√µes":"Cadastrar"})]})]})]})}):null},rt=()=>{const{user:s}=le(),[a,t]=d.useState([]),[o,n]=d.useState(!1),[r,i]=d.useState(null),[l,u]=d.useState(!1),[c,x]=d.useState(!0),[f,v]=d.useState(!1),[p,m]=d.useState(null),[g,N]=d.useState(!1),C=d.useCallback(async()=>{if(s)try{x(!0);const E=await De.getStepsByUser(s.uid);t(E)}catch(E){console.error("Erro ao carregar etapas:",E)}finally{x(!1)}},[s]);d.useEffect(()=>{C()},[C]);const q=async E=>{if(s)try{u(!0),r?(await De.updateStep(r.id,E),W.success("Etapa atualizada com sucesso!",{icon:e.jsx(ce,{size:20})})):(await De.createStep(s.uid,E),W.success("Etapa criada com sucesso!",{icon:e.jsx(ce,{size:20})})),await C(),i(null)}catch(S){console.error("Erro ao salvar etapa:",S);const $=S instanceof Error?S.message:"Erro ao salvar etapa. Tente novamente.";throw W.error($),S}finally{u(!1)}},F=E=>{i(E),n(!0)},_=()=>{n(!1),i(null)},M=E=>{m(E),v(!0)},L=async()=>{if(p)try{N(!0),await De.deleteStep(p),await C(),v(!1),m(null),W.success("Etapa exclu√≠da com sucesso!",{icon:e.jsx(ce,{size:20})})}catch(E){console.error("Erro ao deletar etapa:",E),W.error("Erro ao deletar etapa. Tente novamente.")}finally{N(!1)}};return e.jsxs("div",{className:"tab-content",children:[e.jsxs("div",{className:"tab-header",children:[e.jsx("h2",{className:"tab-title",children:"Etapas de Produ√ß√£o"}),e.jsx("p",{className:"tab-subtitle",children:"Configure as etapas do processo produtivo"})]}),e.jsx("div",{className:"tab-body",children:e.jsxs("div",{className:"etapas-container",children:[e.jsxs("div",{className:"etapas-header",children:[e.jsxs("div",{className:"etapas-title-section",children:[e.jsx("h3",{className:"etapas-title",children:"Etapas de Produ√ß√£o"}),e.jsx("p",{className:"etapas-subtitle",children:"Configure as etapas do processo produtivo"})]}),e.jsxs("button",{className:"etapas-add-button",onClick:()=>{i(null),n(!0)},children:[e.jsx(ke,{className:"etapas-add-icon",size:16}),e.jsx("span",{className:"etapas-add-text",children:"Nova Etapa"})]})]}),e.jsx("div",{className:"etapas-content",children:c?e.jsx("div",{className:"etapas-loading",children:e.jsx("p",{children:"Carregando etapas..."})}):a.length===0?e.jsxs("div",{className:"etapas-empty",children:[e.jsx("p",{children:"Nenhuma etapa cadastrada"}),e.jsx("p",{className:"etapas-empty-subtitle",children:'Clique no bot√£o "Nova Etapa" para adicionar uma etapa'})]}):e.jsx("div",{className:"etapas-table-container",children:e.jsxs("table",{className:"etapas-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ordem"}),e.jsx("th",{children:"Nome"}),e.jsx("th",{children:"Descri√ß√£o"}),e.jsx("th",{children:"A√ß√µes"})]})}),e.jsx("tbody",{children:a.map(E=>e.jsxs("tr",{children:[e.jsx("td",{className:"etapas-order",children:E.order}),e.jsx("td",{className:"etapas-name",children:E.name}),e.jsx("td",{className:"etapas-description",children:E.description}),e.jsxs("td",{className:"etapas-actions",children:[e.jsx("button",{className:"etapas-action etapas-edit",onClick:()=>F(E),title:"Editar etapa",children:e.jsx(Aa,{size:14})}),e.jsx("button",{className:"etapas-action etapas-delete",onClick:()=>M(E.id),title:"Excluir etapa",children:e.jsx(Le,{size:14})})]})]},E.id))})]})})})]})}),e.jsx(tt,{isOpen:o,onClose:_,onSubmit:q,stepToEdit:r,isLoading:l}),e.jsx(Qe,{isOpen:f,onClose:()=>{v(!1),m(null)},onConfirm:L,itemName:a.find(E=>E.id===p)?.name||"",loading:g,title:"Confirmar Exclus√£o",message:"Tem certeza que deseja excluir esta etapa?",confirmText:"Excluir",cancelText:"Cancelar"})]})},ot=({categorias:s,onAdd:a,onEdit:t,onDelete:o})=>{const[n,r]=d.useState(!1),[i,l]=d.useState(null),[u,c]=d.useState({nome:"",descricao:""}),x=p=>{p.preventDefault(),u.nome.trim()&&(i?t(i,u):a(u),c({nome:"",descricao:""}),r(!1),l(null))},f=p=>{c({nome:p.nome,descricao:p.descricao||""}),l(p.id),r(!0)},v=()=>{c({nome:"",descricao:""}),r(!1),l(null)};return e.jsxs("div",{className:"categoria-form",children:[e.jsxs("div",{className:"form-header",children:[e.jsx("h3",{children:"Categorias de Produtos"}),e.jsxs("button",{type:"button",onClick:()=>r(!0),className:"add-button",children:[e.jsx(ke,{size:16}),"Adicionar Categoria"]})]}),n&&e.jsxs("form",{onSubmit:x,className:"form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nome",children:"Nome da Categoria"}),e.jsx("input",{type:"text",id:"nome",value:u.nome,onChange:p=>c({...u,nome:p.target.value}),placeholder:"Ex: Blusa, Regata, Cal√ßa...",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"descricao",children:"Descri√ß√£o (Opcional)"}),e.jsx("textarea",{id:"descricao",value:u.descricao,onChange:p=>c({...u,descricao:p.target.value}),placeholder:"Descri√ß√£o da categoria...",rows:3})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",className:"save-button",children:i?"Atualizar":"Salvar"}),e.jsx("button",{type:"button",onClick:v,className:"cancel-button",children:"Cancelar"})]})]}),e.jsx("div",{className:"categorias-list",children:s.map(p=>e.jsxs("div",{className:"categoria-item",children:[e.jsxs("div",{className:"categoria-info",children:[e.jsx("h4",{children:p.nome}),p.descricao&&e.jsx("p",{className:"descricao",children:p.descricao})]}),e.jsxs("div",{className:"categoria-actions",children:[e.jsx("button",{onClick:()=>f(p),className:"edit-button",children:"Editar"}),e.jsx("button",{onClick:()=>o(p.id),className:"delete-button",children:e.jsx(pe,{size:16})})]})]},p.id))})]})},nt=({cores:s,onAdd:a,onEdit:t,onDelete:o})=>{const[n,r]=d.useState(!1),[i,l]=d.useState(null),[u,c]=d.useState({nome:"",codigo:"#000000"}),x=p=>{p.preventDefault(),u.nome.trim()&&(i?t(i,u):a(u),c({nome:"",codigo:"#000000"}),r(!1),l(null))},f=p=>{c({nome:p.nome,codigo:p.codigo}),l(p.id),r(!0)},v=()=>{c({nome:"",codigo:"#000000"}),r(!1),l(null)};return e.jsxs("div",{className:"cor-form",children:[e.jsxs("div",{className:"form-header",children:[e.jsx("h3",{children:"Cores de Produtos"}),e.jsxs("button",{type:"button",onClick:()=>r(!0),className:"add-button",children:[e.jsx(ke,{size:16}),"Adicionar Cor"]})]}),n&&e.jsxs("form",{onSubmit:x,className:"form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nome",children:"Nome da Cor"}),e.jsx("input",{type:"text",id:"nome",value:u.nome,onChange:p=>c({...u,nome:p.target.value}),placeholder:"Ex: Preto, Marinho, Branco...",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"codigo",children:"C√≥digo da Cor"}),e.jsxs("div",{className:"color-input-group",children:[e.jsx("input",{type:"color",id:"codigo",value:u.codigo,onChange:p=>c({...u,codigo:p.target.value}),className:"color-picker"}),e.jsx("input",{type:"text",value:u.codigo,onChange:p=>c({...u,codigo:p.target.value}),placeholder:"#000000",className:"color-code"})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",className:"save-button",children:i?"Atualizar":"Salvar"}),e.jsx("button",{type:"button",onClick:v,className:"cancel-button",children:"Cancelar"})]})]}),e.jsx("div",{className:"cores-list",children:s.map(p=>e.jsxs("div",{className:"cor-item",children:[e.jsxs("div",{className:"cor-info",children:[e.jsx("div",{className:"cor-preview",style:{backgroundColor:p.codigo}}),e.jsxs("div",{className:"cor-details",children:[e.jsx("h4",{children:p.nome}),e.jsx("p",{className:"codigo",children:p.codigo})]})]}),e.jsxs("div",{className:"cor-actions",children:[e.jsx("button",{onClick:()=>f(p),className:"edit-button",children:"Editar"}),e.jsx("button",{onClick:()=>o(p.id),className:"delete-button",children:e.jsx(pe,{size:16})})]})]},p.id))})]})},it=({tamanhos:s,onAdd:a,onEdit:t,onDelete:o})=>{const[n,r]=d.useState(!1),[i,l]=d.useState(null),[u,c]=d.useState({nome:"",ordem:1}),x=m=>{m.preventDefault(),u.nome.trim()&&(i?t(i,u):a(u),c({nome:"",ordem:1}),r(!1),l(null))},f=m=>{c({nome:m.nome,ordem:m.ordem}),l(m.id),r(!0)},v=()=>{c({nome:"",ordem:1}),r(!1),l(null)},p=[...s].sort((m,g)=>m.ordem-g.ordem);return e.jsxs("div",{className:"tamanho-form",children:[e.jsxs("div",{className:"form-header",children:[e.jsx("h3",{children:"Tamanhos de Produtos"}),e.jsxs("button",{type:"button",onClick:()=>r(!0),className:"add-button",children:[e.jsx(ke,{size:16}),"Adicionar Tamanho"]})]}),n&&e.jsxs("form",{onSubmit:x,className:"form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nome",children:"Nome do Tamanho"}),e.jsx("input",{type:"text",id:"nome",value:u.nome,onChange:m=>c({...u,nome:m.target.value}),placeholder:"Ex: P, M, G, GG, XG...",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"ordem",children:"Ordem de Exibi√ß√£o"}),e.jsx("input",{type:"number",id:"ordem",value:u.ordem,onChange:m=>c({...u,ordem:parseInt(m.target.value)||1}),min:"1",placeholder:"1"}),e.jsx("small",{children:"Menor n√∫mero aparece primeiro"})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",className:"save-button",children:i?"Atualizar":"Salvar"}),e.jsx("button",{type:"button",onClick:v,className:"cancel-button",children:"Cancelar"})]})]}),e.jsx("div",{className:"tamanhos-list",children:p.map(m=>e.jsxs("div",{className:"tamanho-item",children:[e.jsxs("div",{className:"tamanho-info",children:[e.jsx("div",{className:"tamanho-ordem",children:m.ordem}),e.jsx("h4",{children:m.nome})]}),e.jsxs("div",{className:"tamanho-actions",children:[e.jsx("button",{onClick:()=>f(m),className:"edit-button",children:"Editar"}),e.jsx("button",{onClick:()=>o(m.id),className:"delete-button",children:e.jsx(pe,{size:16})})]})]},m.id))})]})},ct=({produtos:s,categorias:a,cores:t,tamanhos:o,onAdd:n,onEdit:r,onDelete:i})=>{const[l,u]=d.useState(!1),[c,x]=d.useState(null),[f,v]=d.useState(!1),[p,m]=d.useState([]),[g,N]=d.useState({refCodigo:"",descricao:"",categoriaId:"",coresIds:[],tamanhosIds:[],etapasProducao:[]}),{user:C}=le();d.useEffect(()=>{(async()=>{if(C)try{const z=await De.getStepsByUser(C.uid);m(z)}catch(z){console.error("Erro ao carregar etapas:",z)}})()},[C]);const q=h=>{h.preventDefault(),!(!g.refCodigo.trim()||!g.descricao.trim()||!g.categoriaId)&&(c?r(c,g):n(g),F())},F=()=>{N({refCodigo:"",descricao:"",categoriaId:"",coresIds:[],tamanhosIds:[],etapasProducao:[]}),u(!1),x(null),v(!1)},_=h=>{N({refCodigo:h.refCodigo,descricao:h.descricao,categoriaId:h.categoria.id,coresIds:h.cores.map(z=>z.id),tamanhosIds:h.tamanhos.map(z=>z.id),etapasProducao:h.etapasProducao?.map(z=>({etapaId:z.etapa.id,custo:z.custo,ordem:z.ordem}))||[]}),x(h.id),u(!0)},M=h=>{N({...g,categoriaId:h})},L=h=>{const z=g.coresIds.includes(h)?g.coresIds.filter(P=>P!==h):[...g.coresIds,h];N({...g,coresIds:z})},E=h=>{const z=g.tamanhosIds.includes(h)?g.tamanhosIds.filter(P=>P!==h):[...g.tamanhosIds,h];N({...g,tamanhosIds:z})},S=h=>{const z=g.etapasProducao||[];if(z.some(w=>w.etapaId===h))N({...g,etapasProducao:z.filter(w=>w.etapaId!==h)});else{const w=p.find(V=>V.id===h);w&&N({...g,etapasProducao:[...z,{etapaId:w.id,custo:0,ordem:w.order}]})}},$=(h,z)=>{const P=g.etapasProducao||[];N({...g,etapasProducao:P.map(w=>w.etapaId===h?{...w,custo:Math.max(0,z)}:w)})},ie=a.find(h=>h.id===g.categoriaId);return e.jsxs("div",{className:"produto-form",children:[e.jsxs("div",{className:"form-header",children:[e.jsx("h3",{children:"Produtos"}),e.jsxs("button",{type:"button",onClick:()=>u(!0),className:"add-button",children:[e.jsx(ke,{size:16}),"Adicionar Produto"]})]}),l&&e.jsxs("form",{onSubmit:q,className:"form",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"refCodigo",children:"REF/C√ìD"}),e.jsx("input",{type:"text",id:"refCodigo",value:g.refCodigo,onChange:h=>N({...g,refCodigo:h.target.value}),placeholder:"Ex: BLU-001, REG-002...",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"descricao",children:"Descri√ß√£o"}),e.jsx("input",{type:"text",id:"descricao",value:g.descricao,onChange:h=>N({...g,descricao:h.target.value}),placeholder:"Descri√ß√£o do produto...",required:!0})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Categoria"}),e.jsxs("div",{className:"dropdown",children:[e.jsxs("button",{type:"button",className:"dropdown-button",onClick:()=>v(!f),children:[ie?ie.nome:"Selecione uma categoria",e.jsx(oa,{size:16})]}),f&&e.jsx("div",{className:"dropdown-menu",children:a.map(h=>e.jsx("button",{type:"button",onClick:()=>{M(h.id),v(!1)},className:"dropdown-item",children:h.nome},h.id))})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Cores"}),e.jsx("div",{className:"checkbox-grid",children:t.map(h=>e.jsxs("label",{className:"checkbox-item",children:[e.jsx("input",{type:"checkbox",checked:g.coresIds.includes(h.id),onChange:()=>L(h.id)}),e.jsx("div",{className:"color-preview",style:{backgroundColor:h.codigo}}),e.jsx("span",{children:h.nome})]},h.id))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tamanhos"}),e.jsx("div",{className:"checkbox-grid",children:o.sort((h,z)=>h.ordem-z.ordem).map(h=>e.jsxs("label",{className:"checkbox-item",children:[e.jsx("input",{type:"checkbox",checked:g.tamanhosIds.includes(h.id),onChange:()=>E(h.id)}),e.jsx("span",{children:h.nome})]},h.id))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Etapas de Produ√ß√£o e Custos"}),e.jsx("div",{className:"etapas-container-simple",children:p.length>0?e.jsx("div",{className:"etapas-grid",children:p.map(h=>{const z=g.etapasProducao?.find(w=>w.etapaId===h.id),P=!!z;return e.jsxs("div",{className:`etapa-card ${P?"active":""}`,children:[e.jsx("div",{className:"etapa-card-header",children:e.jsxs("label",{className:"etapa-card-checkbox",children:[e.jsx("input",{type:"checkbox",checked:P,onChange:()=>S(h.id)}),e.jsxs("div",{className:"etapa-card-info",children:[e.jsx("span",{className:"etapa-card-nome",children:h.name}),h.description&&e.jsx("span",{className:"etapa-card-desc",children:h.description})]})]})}),P&&e.jsxs("div",{className:"etapa-card-custo",children:[e.jsx("label",{children:"Custo"}),e.jsxs("div",{className:"currency-input",children:[e.jsx("span",{className:"currency-symbol",children:"R$"}),e.jsx("input",{type:"text",value:z?.custo?z.custo.toFixed(2).replace(".",","):"0,00",onChange:w=>{const V=w.target.value.replace(/\D/g,"").padStart(3,"0"),Y=Rs(V);$(h.id,Y)},placeholder:"0,00",maxLength:15})]})]})]},h.id)})}):e.jsxs("div",{className:"etapas-empty",children:[e.jsx("p",{children:"Nenhuma etapa cadastrada ainda."}),e.jsx("span",{children:'Cadastre etapas na aba "Etapas" primeiro.'})]})})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",className:"save-button",children:c?"Atualizar":"Salvar"}),e.jsx("button",{type:"button",onClick:F,className:"cancel-button",children:"Cancelar"})]})]}),e.jsx("div",{className:"produtos-list",children:s.map(h=>e.jsxs("div",{className:"produto-item",children:[e.jsxs("div",{className:"produto-info",children:[e.jsxs("div",{className:"produto-header",children:[e.jsx("h4",{children:h.refCodigo}),e.jsx("span",{className:"categoria",children:h.categoria.nome})]}),e.jsx("p",{className:"descricao",children:h.descricao}),e.jsxs("div",{className:"produto-details",children:[e.jsxs("div",{className:"cores",children:[e.jsx("strong",{children:"Cores:"})," ",h.cores.map(z=>z.nome).join(", ")]}),e.jsxs("div",{className:"tamanhos",children:[e.jsx("strong",{children:"Tamanhos:"})," ",h.tamanhos.map(z=>z.nome).join(", ")]})]})]}),e.jsxs("div",{className:"produto-actions",children:[e.jsx("button",{onClick:()=>_(h),className:"edit-button",children:"Editar"}),e.jsx("button",{onClick:()=>i(h.id),className:"delete-button",children:e.jsx(pe,{size:16})})]})]},h.id))})]})},dt=()=>{const{user:s}=le(),[a,t]=d.useState("produtos"),[o,n]=d.useState(!0),[r,i]=d.useState([]),[l,u]=d.useState([]),[c,x]=d.useState([]),[f,v]=d.useState([]),[p,m]=d.useState(!1),[g,N]=d.useState(null),[C,q]=d.useState(null),[F,_]=d.useState(!1),M=(j,I)=>{N(j),q(I),m(!0)},L=async()=>{if(!(!g||!C))try{switch(_(!0),C){case"produto":await we.deleteProduto(g),W.success("Produto exclu√≠do com sucesso!",{icon:e.jsx(ce,{size:20})});break;case"categoria":await ea.deleteCategoria(g),W.success("Categoria exclu√≠da com sucesso!",{icon:e.jsx(ce,{size:20})});break;case"cor":await We.deleteCor(g),W.success("Cor exclu√≠da com sucesso!",{icon:e.jsx(ce,{size:20})});break;case"tamanho":await Me.deleteTamanho(g),W.success("Tamanho exclu√≠do com sucesso!",{icon:e.jsx(ce,{size:20})});break}await $(),m(!1),N(null),q(null)}catch(j){console.error(`Erro ao deletar ${C}:`,j);const I=j instanceof Error?j.message:`Erro ao excluir ${C}. Tente novamente.`;W.error(I)}finally{_(!1)}},E=()=>{if(!(!g||!C))switch(C){case"produto":return f.find(j=>j.id===g)?.descricao||void 0;case"categoria":return r.find(j=>j.id===g)?.nome||void 0;case"cor":return l.find(j=>j.id===g)?.nome||void 0;case"tamanho":return c.find(j=>j.id===g)?.nome||void 0}},S=()=>{switch(C){case"produto":return"Tem certeza que deseja excluir este produto?";case"categoria":return"Tem certeza que deseja excluir esta categoria?";case"cor":return"Tem certeza que deseja excluir esta cor?";case"tamanho":return"Tem certeza que deseja excluir este tamanho?";default:return"Tem certeza que deseja excluir este item?"}},$=d.useCallback(async()=>{if(s)try{n(!0);const[j,I,T,B,X]=await Promise.all([ea.getCategorias(s.uid),We.getCores(s.uid),Me.getTamanhos(s.uid),De.getStepsByUser(s.uid),we.getProdutos(s.uid)]);i(j),u(I),x(T);const re=X.map(se=>{const y=j.find(H=>H.id===se.categoriaId),A=I.filter(H=>se.coresIds?.includes(H.id)),O=T.filter(H=>se.tamanhosIds?.includes(H.id)),K=(se.etapasProducaoIds||[]).map(H=>{const de=B.find(U=>U.id===H.etapaId);return de?{etapa:{id:de.id,nome:de.name,descricao:de.description||void 0,custo:H.custo,ativo:!0,createdAt:de.createdAt},custo:H.custo,ordem:H.ordem}:null}).filter(H=>H!==null);return{...se,categoria:y||se.categoria,cores:A.length>0?A:se.cores||[],tamanhos:O.length>0?O:se.tamanhos||[],etapasProducao:K}});v(re)}catch(j){console.error("Erro ao carregar dados:",j)}finally{n(!1)}},[s]);d.useEffect(()=>{s&&$()},[s,$]);const ie=async j=>{if(s)try{await ea.createCategoria(s.uid,j),await $()}catch(I){console.error("Erro ao adicionar categoria:",I),alert("Erro ao adicionar categoria")}},h=async(j,I)=>{try{await ea.updateCategoria(j,I),await $()}catch(T){console.error("Erro ao editar categoria:",T),alert("Erro ao editar categoria")}},z=async j=>{if(s)try{await We.createCor(s.uid,j),await $()}catch(I){console.error("Erro ao adicionar cor:",I),alert("Erro ao adicionar cor")}},P=async(j,I)=>{try{await We.updateCor(j,I),await $()}catch(T){console.error("Erro ao editar cor:",T),alert("Erro ao editar cor")}},w=async j=>{if(s)try{await Me.createTamanho(s.uid,j),await $()}catch(I){console.error("Erro ao adicionar tamanho:",I),alert("Erro ao adicionar tamanho")}},V=async(j,I)=>{try{await Me.updateTamanho(j,I),await $()}catch(T){console.error("Erro ao editar tamanho:",T),alert("Erro ao editar tamanho")}},Y=async j=>{if(s)try{await we.createProduto(s.uid,j),await $(),W.success("Produto criado com sucesso!",{icon:e.jsx(ce,{size:20})})}catch(I){console.error("Erro ao adicionar produto:",I);const T=I instanceof Error?I.message:"Erro ao criar produto. Tente novamente.";W.error(T)}},b=async(j,I)=>{try{await we.updateProduto(j,I),await $()}catch(T){console.error("Erro ao editar produto:",T),alert("Erro ao editar produto")}},k=[{key:"produtos",label:"Produtos",icon:ze},{key:"categorias",label:"Categorias",icon:as},{key:"cores",label:"Cores",icon:ss},{key:"tamanhos",label:"Tamanhos",icon:ts}],R=()=>{switch(a){case"produtos":return e.jsx(ct,{produtos:f,categorias:r,cores:l,tamanhos:c,onAdd:Y,onEdit:b,onDelete:j=>M(j,"produto")});case"categorias":return e.jsx(ot,{categorias:r,onAdd:ie,onEdit:h,onDelete:j=>M(j,"categoria")});case"cores":return e.jsx(nt,{cores:l,onAdd:z,onEdit:P,onDelete:j=>M(j,"cor")});case"tamanhos":return e.jsx(it,{tamanhos:c,onAdd:w,onEdit:V,onDelete:j=>M(j,"tamanho")});default:return null}};return e.jsxs("div",{className:"tab-content",children:[e.jsxs("div",{className:"tab-header",children:[e.jsx("h2",{className:"tab-title",children:"Produtos"}),e.jsx("p",{className:"tab-subtitle",children:"Gerencie produtos, categorias, cores e tamanhos"})]}),o?e.jsx("div",{style:{textAlign:"center",padding:"3rem"},children:e.jsx("p",{children:"Carregando dados..."})}):e.jsxs("div",{className:"product-tabs",children:[e.jsx("div",{className:"product-tab-nav",children:k.map(j=>e.jsxs("button",{onClick:()=>t(j.key),className:`product-tab-button ${a===j.key?"active":""}`,children:[e.jsx(j.icon,{size:16}),j.label]},j.key))}),e.jsx("div",{className:"product-tab-content",children:R()})]}),e.jsx(Qe,{isOpen:p,onClose:()=>{m(!1),N(null),q(null)},onConfirm:L,itemName:E()||"",message:S(),loading:F,title:"Confirmar Exclus√£o",confirmText:"Excluir",cancelText:"Cancelar"})]})},lt="modulepreload",mt=function(s){return"/"+s},Da={},ut=function(a,t,o){let n=Promise.resolve();if(t&&t.length>0){let u=function(c){return Promise.all(c.map(x=>Promise.resolve(x).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=i?.nonce||i?.getAttribute("nonce");n=u(t.map(c=>{if(c=mt(c),c in Da)return;Da[c]=!0;const x=c.endsWith(".css"),f=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const v=document.createElement("link");if(v.rel=x?"stylesheet":lt,x||(v.as="script"),v.crossOrigin="",v.href=c,l&&v.setAttribute("nonce",l),document.head.appendChild(v),x)return new Promise((p,m)=>{v.addEventListener("load",p),v.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return n.then(i=>{for(const l of i||[])l.status==="rejected"&&r(l.reason);return a().catch(r)})},ht=[{label:"Alta",value:"alta"},{label:"M√©dia",value:"media"},{label:"Baixa",value:"baixa"}],pt=({isOpen:s,onClose:a,onSubmit:t,isSubmitting:o,orderToEdit:n})=>{const{user:r}=le(),[i,l]=d.useState([]),[u,c]=d.useState([]),[x,f]=d.useState([]),[v,p]=d.useState(""),[m,g]=d.useState({produtoId:"",prioridade:"",dataInicio:"",dataPrevista:"",responsavelId:""}),[N,C]=d.useState([]),[q,F]=d.useState(""),[_,M]=d.useState(!1),L=d.useRef(null);d.useEffect(()=>{!r||!s||(async()=>{const[b,k,R,j]=await Promise.all([we.getProdutos(r.uid),We.getCores(r.uid),Me.getTamanhos(r.uid),Ce.getFaccoes()]);c(k),f(j.filter(T=>T.ativo)),p(k[0]?.id||"");const I=b.map(T=>{const B=R.filter(X=>T.tamanhosIds?.includes(X.id||""));return{...T,tamanhos:B.length>0?B:[]}});l(I)})()},[r,s]),d.useEffect(()=>{s||(g({produtoId:"",prioridade:"",dataInicio:"",dataPrevista:"",responsavelId:""}),C([]),F(""),M(!1))},[s]),d.useEffect(()=>{if(s&&n){g({produtoId:n.produtoId,prioridade:n.prioridade,dataInicio:n.dataInicio,dataPrevista:n.dataPrevista,responsavelId:n.responsavelId||""});const b=i.find(R=>R.id===n.produtoId);b&&F(b.refCodigo);const k=n.grade.map(R=>{if(R.quantidades)return{corId:R.corId,quantidades:R.quantidades};{const j=i.find(I=>I.id===n.produtoId);if(j&&j.tamanhos){const I={},T=[...j.tamanhos].sort((X,re)=>X.ordem-re.ordem),B=["pp","p","m","g","gg"];return T.forEach((X,re)=>{if(re<B.length){const se=B[re],y=R;I[X.id]=y[se]||0}}),{corId:R.corId,quantidades:I}}return{corId:R.corId,quantidades:{}}}});C(k)}},[s,n,i]);const E=d.useMemo(()=>i.find(b=>b.id===m.produtoId),[i,m.produtoId]),S=d.useMemo(()=>!E||!E.tamanhosIds?[]:[...E.tamanhos].sort((b,k)=>b.ordem-k.ordem),[E]),$=d.useMemo(()=>{if(!q.trim())return i;const b=q.toLowerCase();return i.filter(k=>k.refCodigo.toLowerCase().includes(b)||k.descricao.toLowerCase().includes(b))},[i,q]),ie=d.useMemo(()=>`1.5 fr repeat(${S.length}, 0.8fr) 1fr 0.4fr`,[S]);d.useEffect(()=>{const b=k=>{L.current&&!L.current.contains(k.target)&&M(!1)};return document.addEventListener("mousedown",b),()=>document.removeEventListener("mousedown",b)},[]),d.useEffect(()=>{F(E?E.refCodigo:"")},[E]);const h=()=>{if(!v||N.some(k=>k.corId===v))return;const b={};S.forEach(k=>{b[k.id]=0}),C(k=>[...k,{corId:v,quantidades:b}])},z=b=>{C(k=>k.filter(R=>R.corId!==b))},P=(b,k,R)=>{C(j=>j.map(I=>I.corId===b?{...I,quantidades:{...I.quantidades,[k]:Number.isNaN(R)?0:Math.max(0,Math.floor(R))}}:I))},w=b=>Object.values(b.quantidades).reduce((k,R)=>k+R,0),V=N.reduce((b,k)=>b+w(k),0),Y=async b=>{if(b.preventDefault(),!E||!m.prioridade||!m.dataInicio||!m.dataPrevista||N.length===0)return;const k={produtoId:E.id,prioridade:m.prioridade,dataInicio:m.dataInicio,dataPrevista:m.dataPrevista,responsavelId:m.responsavelId||void 0,grade:N.map(R=>{const j=u.find(I=>I.id===R.corId);return{corId:R.corId,corNome:j?.nome??"Cor removida",quantidades:R.quantidades}})};await t(k)};return s?e.jsx("div",{className:"order-modal-overlay",children:e.jsxs("div",{className:"order-modal",children:[e.jsxs("header",{className:"order-modal__header",children:[e.jsxs("div",{children:[e.jsx("h2",{children:n?"Editar Ordem de Produ√ß√£o":"Nova Ordem de Produ√ß√£o"}),e.jsx("p",{children:n?"Edite os dados da ordem de produ√ß√£o.":"Crie uma nova ordem com todas as especifica√ß√µes."})]}),e.jsx("button",{className:"order-modal__close",onClick:a,children:e.jsx(pe,{size:18})})]}),e.jsxs("form",{className:"order-modal__form",onSubmit:Y,children:[e.jsxs("div",{className:"order-modal__grid",children:[e.jsxs("label",{className:"order-modal__field",children:[e.jsx("span",{children:"Produto*"}),e.jsxs("div",{ref:L,className:"order-modal__product-search",children:[e.jsxs("div",{className:"order-modal__product-input-wrapper",children:[e.jsx(_e,{size:18,className:"order-modal__search-icon"}),e.jsx("input",{type:"text",value:q,onChange:b=>{F(b.target.value),M(!0),b.target.value||g(k=>({...k,produtoId:""}))},onFocus:()=>M(!0),placeholder:"Pesquisar por REF..."})]}),_&&q.trim()&&!E&&e.jsx("div",{className:"order-modal__product-dropdown",children:$.length>0?$.map(b=>e.jsxs("button",{type:"button",className:"order-modal__product-option",onClick:()=>{g(k=>({...k,produtoId:b.id})),F(b.refCodigo),M(!1)},children:[e.jsx("div",{className:"order-modal__product-option-ref",children:b.refCodigo}),e.jsx("div",{className:"order-modal__product-option-desc",children:b.descricao})]},b.id)):e.jsx("div",{className:"order-modal__product-empty",children:"Nenhum produto encontrado"})}),E&&e.jsxs("div",{className:"order-modal__product-selected",children:[e.jsx("span",{className:"order-modal__product-selected-label",children:"Descri√ß√£o:"}),e.jsx("span",{className:"order-modal__product-selected-value",children:E.descricao})]})]})]}),e.jsxs("label",{className:"order-modal__field",children:[e.jsx("span",{children:"Prioridade*"}),e.jsxs("select",{value:m.prioridade,onChange:b=>g(k=>({...k,prioridade:b.target.value})),required:!0,children:[e.jsx("option",{value:"",children:"Selecione uma prioridade"}),ht.map(b=>e.jsx("option",{value:b.value,children:b.label},b.value))]})]}),e.jsxs("label",{className:"order-modal__field",children:[e.jsx("span",{children:"Respons√°vel (Fac√ß√£o)"}),e.jsxs("select",{value:m.responsavelId,onChange:b=>g(k=>({...k,responsavelId:b.target.value})),children:[e.jsx("option",{value:"",children:"Nenhum respons√°vel"}),x.map(b=>e.jsx("option",{value:b.id,children:b.nome},b.id))]})]}),e.jsxs("label",{className:"order-modal__field",children:[e.jsx("span",{children:"Data de In√≠cio"}),e.jsx("input",{type:"date",value:m.dataInicio,onChange:b=>g(k=>({...k,dataInicio:b.target.value}))})]}),e.jsxs("label",{className:"order-modal__field",children:[e.jsx("span",{children:"Data Prevista"}),e.jsx("input",{type:"date",value:m.dataPrevista,onChange:b=>g(k=>({...k,dataPrevista:b.target.value}))})]})]}),e.jsxs("section",{className:"order-modal__grade",children:[e.jsxs("div",{className:"order-modal__grade-header",children:[e.jsx("h3",{children:"Grade de Produ√ß√£o"}),e.jsxs("div",{className:"order-modal__grade-actions",children:[e.jsx("select",{value:v,onChange:b=>p(b.target.value),children:u.map(b=>e.jsx("option",{value:b.id,children:b.nome},b.id))}),e.jsx("button",{type:"button",className:"order-modal__grade-add",onClick:h,disabled:!v,children:e.jsx(ke,{size:18})})]})]}),e.jsxs("div",{className:"order-modal__grade-table",children:[e.jsxs("div",{className:"order-modal__grade-header-row",style:{gridTemplateColumns:ie},children:[e.jsx("span",{children:"Cor"}),S.map(b=>e.jsx("span",{children:b.nome},b.id)),e.jsx("span",{children:"Total"}),e.jsx("span",{})]}),N.map(b=>{const k=u.find(R=>R.id===b.corId);return e.jsxs("div",{className:"order-modal__grade-row",style:{gridTemplateColumns:ie},children:[e.jsx("span",{children:k?.nome??"Cor removida"}),S.map(R=>e.jsx("input",{type:"number",min:0,value:b.quantidades[R.id]||0,onChange:j=>P(b.corId,R.id,Number(j.target.value))},R.id)),e.jsx("span",{className:"order-modal__grade-total",children:w(b)}),e.jsx("button",{type:"button",className:"order-modal__grade-remove",onClick:()=>z(b.corId),children:e.jsx(Le,{size:18})})]},b.corId)}),N.length===0&&e.jsx("div",{className:"order-modal__grade-empty",children:"Nenhuma cor adicionado ainda"})]}),e.jsxs("footer",{className:"order-modal__grade-footer",children:[e.jsx("span",{children:"Total de pe√ßas:"}),e.jsx("strong",{children:V})]})]}),e.jsxs("footer",{className:"order-modal__footer",children:[e.jsx("button",{type:"button",disabled:o,className:"order-modal__btn outline",onClick:a,children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:o,className:"order-modal__btn primary",children:o?n?"Atualizando...":"Criando...":n?"Atualizar Ordem":"Criar Ordem"})]})]})]})}):null},xt=({isOpen:s,onClose:a,order:t,produto:o})=>{const n=d.useRef(null),r=()=>{window.print()},i=c=>c?new Date(c).toLocaleDateString("pt-BR"):"--",l=()=>t.grade.reduce((c,x)=>c+x.total,0),u=()=>{if(!t.grade||t.grade.length===0)return[];const c=t.grade[0];return Object.keys(c.quantidades)};return s?e.jsx("div",{className:"print-modal-overlay",children:e.jsxs("div",{className:"print-modal",children:[e.jsxs("div",{className:"print-modal-header no-print",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"Impress√£o de Ordem de Produ√ß√£o"}),e.jsx("p",{children:"Visualize antes de imprimir"})]}),e.jsxs("div",{className:"print-modal-actions",children:[e.jsxs("button",{className:"btn-print",onClick:r,children:[e.jsx(da,{size:18}),"Imprimir"]}),e.jsx("button",{className:"btn-close",onClick:a,children:e.jsx(pe,{size:18})})]})]}),e.jsx("div",{className:"print-modal-content",ref:n,children:e.jsxs("div",{className:"print-page",children:[e.jsxs("div",{className:"print-header",children:[e.jsxs("div",{className:"print-title-section",children:[e.jsx("h1",{className:"print-main-title",children:"ORDEM DE PRODU√á√ÉO"}),e.jsx("div",{className:"print-order-code",children:t.codigo})]}),e.jsxs("div",{className:"print-date-info",children:[e.jsxs("div",{className:"print-date-item",children:[e.jsx("strong",{children:"Data Emiss√£o:"}),e.jsx("span",{children:i(t.createdAt.toISOString())})]}),e.jsxs("div",{className:"print-date-item",children:[e.jsx("strong",{children:"Data In√≠cio:"}),e.jsx("span",{children:i(t.dataInicio)})]}),e.jsxs("div",{className:"print-date-item",children:[e.jsx("strong",{children:"Previs√£o:"}),e.jsx("span",{children:i(t.dataPrevista)})]})]})]}),e.jsxs("div",{className:"print-section",children:[e.jsx("h2",{className:"print-section-title",children:"DADOS DO PRODUTO"}),e.jsxs("div",{className:"print-info-grid",children:[e.jsxs("div",{className:"print-info-item",children:[e.jsx("span",{className:"print-label",children:"Refer√™ncia:"}),e.jsx("span",{className:"print-value",children:t.produtoRef})]}),e.jsxs("div",{className:"print-info-item",children:[e.jsx("span",{className:"print-label",children:"Descri√ß√£o:"}),e.jsx("span",{className:"print-value",children:t.produtoDescricao})]}),e.jsxs("div",{className:"print-info-item",children:[e.jsx("span",{className:"print-label",children:"Categoria:"}),e.jsx("span",{className:"print-value",children:o?.categoria?.nome||"N/A"})]}),e.jsxs("div",{className:"print-info-item",children:[e.jsx("span",{className:"print-label",children:"Prioridade:"}),e.jsx("span",{className:"print-value print-priority",children:t.prioridade.toUpperCase()})]})]})]}),e.jsxs("div",{className:"print-section",children:[e.jsx("h2",{className:"print-section-title",children:"GRADE DE PRODU√á√ÉO"}),e.jsxs("table",{className:"print-grade-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"print-table-header",children:"Cor"}),u().map(c=>e.jsx("th",{className:"print-table-header print-table-center",children:c},c)),e.jsx("th",{className:"print-table-header print-table-center",children:"Total"})]})}),e.jsxs("tbody",{children:[t.grade.map((c,x)=>e.jsxs("tr",{children:[e.jsx("td",{className:"print-table-cell print-table-bold",children:c.corNome}),u().map(f=>e.jsx("td",{className:"print-table-cell print-table-center",children:c.quantidades[f]||0},f)),e.jsx("td",{className:"print-table-cell print-table-center print-table-bold",children:c.total})]},x)),e.jsxs("tr",{className:"print-table-footer",children:[e.jsx("td",{className:"print-table-cell print-table-bold",children:"TOTAL GERAL"}),u().map(c=>e.jsx("td",{className:"print-table-cell print-table-center print-table-bold",children:t.grade.reduce((x,f)=>x+(f.quantidades[c]||0),0)},c)),e.jsx("td",{className:"print-table-cell print-table-center print-table-bold print-total-highlight",children:l()})]})]})]})]}),e.jsxs("div",{className:"print-section",children:[e.jsx("h2",{className:"print-section-title",children:"RESPONS√ÅVEL"}),e.jsxs("div",{className:"print-info-box",children:[e.jsx("span",{className:"print-label",children:"Respons√°vel pela Produ√ß√£o:"}),e.jsx("span",{className:"print-value",children:t.responsavelNome||"N√£o atribu√≠do"})]})]}),o?.etapasProducao&&o.etapasProducao.length>0&&e.jsxs("div",{className:"print-section",children:[e.jsx("h2",{className:"print-section-title",children:"ETAPAS DE PRODU√á√ÉO"}),e.jsxs("table",{className:"print-steps-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"print-table-header",children:"Ordem"}),e.jsx("th",{className:"print-table-header",children:"Etapa"}),e.jsx("th",{className:"print-table-header",children:"Descri√ß√£o"}),e.jsx("th",{className:"print-table-header print-table-center",children:"Valor"})]})}),e.jsx("tbody",{children:o.etapasProducao.map((c,x)=>e.jsxs("tr",{children:[e.jsx("td",{className:"print-table-cell print-table-center",children:c.ordem}),e.jsx("td",{className:"print-table-cell",children:c.etapa.nome}),e.jsx("td",{className:"print-table-cell",children:c.etapa.descricao||"-"}),e.jsxs("td",{className:"print-table-cell print-table-center",children:["R$ ",c.custo.toFixed(2)]})]},x))})]})]}),e.jsxs("div",{className:"print-section",children:[e.jsx("h2",{className:"print-section-title",children:"OBSERVA√á√ïES"}),e.jsxs("div",{className:"print-observations",children:[e.jsx("div",{className:"print-observation-line"}),e.jsx("div",{className:"print-observation-line"}),e.jsx("div",{className:"print-observation-line"})]})]}),e.jsxs("div",{className:"print-signatures",children:[e.jsxs("div",{className:"print-signature-box",children:[e.jsx("div",{className:"print-signature-line"}),e.jsx("span",{className:"print-signature-label",children:"Respons√°vel pela Emiss√£o"})]}),e.jsxs("div",{className:"print-signature-box",children:[e.jsx("div",{className:"print-signature-line"}),e.jsx("span",{className:"print-signature-label",children:"Respons√°vel pela Produ√ß√£o"})]})]}),e.jsx("div",{className:"print-footer",children:e.jsxs("p",{children:["Documento gerado em ",new Date().toLocaleString("pt-BR")," - Sistema de Gest√£o de Produ√ß√£o"]})})]})})]})}):null},Sa={alta:{label:"Alta",className:"badge priority-high"},media:{label:"M√©dia",className:"badge priority-medium"},baixa:{label:"Baixa",className:"badge priority-low"}},Ia={planejada:{label:"Planejada",className:"badge status-gray"},em_producao:{label:"Em Produ√ß√£o",className:"badge status-warning"},concluida:{label:"Conclu√≠da",className:"badge status-success"}},ft=()=>{const{user:s}=le(),[a,t]=d.useState([]),[o,n]=d.useState([]),[r,i]=d.useState([]),[l,u]=d.useState(""),[c,x]=d.useState(!1),[f,v]=d.useState(!1),[p,m]=d.useState(null),[g,N]=d.useState(!0),[C,q]=d.useState(!1),[F,_]=d.useState(null),[M,L]=d.useState(!1),[E,S]=d.useState(!1),[$,ie]=d.useState(null),h=j=>{_(j),q(!0)},z=j=>{ie(j),S(!0)},P=async()=>{if(F)try{try{const j=await xe.getProgressByOrderId(F);j&&await xe.deleteProgress(j.id)}catch(j){console.error("Erro ao deletar progresso:",j)}try{await Ee.deleteLancamentosByOrdem(F)}catch(j){console.error("Erro ao deletar lan√ßamentos financeiros:",j)}await Pe.deleteOrder(F),await w(),q(!1),_(null),W.success("Ordem de produ√ß√£o exclu√≠da com sucesso!",{icon:e.jsx(ce,{size:20})})}catch(j){console.error("Erro ao deletar ordem de produ√ß√£o:",j),W.error("Erro ao deletar ordem de produ√ß√£o. Tente novamente.")}finally{L(!1)}},w=d.useCallback(async()=>{if(s)try{N(!0);const[j,I,T]=await Promise.all([Pe.getOrders(s.uid),we.getProdutos(s.uid),Me.getTamanhos(s.uid)]),B=I.map(X=>{const re=T.filter(se=>X.tamanhosIds?.includes(se.id));return{...X,tamanhos:re.length>0?re:X.tamanhos||[]}});t(j),n(B),i(T)}catch(j){console.error("Erro ao carregar dados:",j)}finally{N(!1)}},[s]);d.useEffect(()=>{w()},[w]);const V=d.useMemo(()=>{const j=l.trim().toLowerCase();return j?a.filter(I=>{const T=o.find(B=>B.id===I.produtoId);return I.codigo.toLowerCase().includes(j)||T?.descricao.toLowerCase().includes(j)||T?.refCodigo.toLowerCase().includes(j)}):a},[a,o,l]),Y=j=>j.grade.reduce((I,T)=>I+T.total,0),b=async j=>{if(!s)return;const I=o.find(T=>T.id===j.produtoId);if(!I){W.error("Produto n√£o encontrado");return}try{v(!0);let T;if(j.responsavelId){const{faccaoService:B}=await ut(async()=>{const{faccaoService:se}=await Promise.resolve().then(()=>Gs);return{faccaoService:se}},void 0);T=(await B.getFaccoes()).find(se=>se.id===j.responsavelId)?.nome}p?(await Pe.updateOrder(p.id,j,{descricao:I.descricao,refCodigo:I.refCodigo},T),W.success("Ordem de produ√ß√£o atualizada com sucesso!",{icon:e.jsx(ce,{size:20})})):(await Pe.createOrder(s.uid,j,{descricao:I.descricao,refCodigo:I.refCodigo},T),W.success("Ordem de produ√ß√£o criada com sucesso!",{icon:e.jsx(ce,{size:20})})),await w(),x(!1),m(null)}catch(T){console.error("Erro ao criar ordem de produ√ß√£o:",T);const B=T instanceof Error?T.message:"Erro ao criar ordem de produ√ß√£o. Tente novamente.";W.error(B)}finally{v(!1)}},k=j=>{m(j),x(!0)},R=()=>{m(null),x(!0)};return g?e.jsx("div",{className:"ordens-container",children:e.jsx("header",{className:"ordens-header",children:e.jsxs("div",{children:[e.jsx("h2",{children:"Ordens de Produ√ß√£o"}),e.jsx("p",{children:"Carregando dados..."})]})})}):e.jsxs("div",{className:"ordens-container",children:[e.jsxs("header",{className:"ordens-header",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"Ordens de Produ√ß√£o"}),e.jsx("p",{children:"Programe e gerencie suas ordens de produ√ß√£o"})]}),e.jsxs("button",{className:"ordens-new-btn",onClick:R,children:[e.jsx(ke,{size:20}),"Nova Ordem"]})]}),e.jsxs("div",{className:"ordens-search",children:[e.jsx(_e,{size:18}),e.jsx("input",{type:"text",placeholder:"Buscar por n√∫mero da OP, produto ou refer√™ncia...",value:l,onChange:j=>u(j.target.value)})]}),e.jsxs("section",{className:"ordens-list",children:[V.map(j=>{const I=o.find(B=>B.id===j.produtoId);let T=I?.tamanhos?[...I.tamanhos].sort((B,X)=>B.ordem-X.ordem):[];if(T.length===0&&j.grade.length>0){const B=j.grade[0];if(B.quantidades){const X=Object.keys(B.quantidades);T=r.filter(re=>X.includes(re.id)).sort((re,se)=>re.ordem-se.ordem)}}return e.jsxs("article",{className:"ordem-card",children:[e.jsxs("div",{className:"ordem-card__header",children:[e.jsxs("div",{className:"ordem-card__header-left",children:[e.jsx("div",{className:"ordem-card__icon",children:e.jsx(fa,{size:24})}),e.jsxs("div",{className:"ordem-card__info-main",children:[e.jsx("div",{className:"ordem-card__code",children:j.codigo}),e.jsx("h3",{className:"ordem-card__title",children:I?.descricao??"Produto removido"}),e.jsxs("div",{className:"ordem-card__meta",children:[e.jsxs("div",{className:"ordem-card__meta-item",children:[e.jsx("span",{children:"REF:"}),e.jsx("strong",{children:I?.refCodigo??"--"})]}),e.jsx("span",{className:"badge badge-neutral",children:I?.categoria?.nome??"Categoria"})]})]})]}),e.jsxs("div",{className:"ordem-card__header-right",children:[e.jsxs("div",{className:"ordem-card__status",children:[e.jsx("span",{className:Sa[j.prioridade].className,children:Sa[j.prioridade].label}),e.jsx("span",{className:Ia[j.status].className,children:Ia[j.status].label})]}),e.jsxs("div",{className:"ordem-card__actions",children:[e.jsx("button",{className:"icon-button",onClick:()=>z(j),title:"Imprimir ordem",children:e.jsx(da,{size:16})}),e.jsx("button",{className:"icon-button",onClick:()=>k(j),children:e.jsx(rs,{size:16})}),e.jsx("button",{className:"icon-button icon-button-danger",onClick:()=>h(j.id),title:"Excluir ordem",children:e.jsx(Le,{size:16})})]})]})]}),e.jsxs("div",{className:"ordem-card__body",children:[e.jsxs("div",{className:"ordem-card__dates",children:[e.jsxs("div",{className:"ordem-card__date-item",children:[e.jsx("div",{className:"ordem-card__date-icon",children:e.jsx(Fe,{size:18})}),e.jsxs("div",{className:"ordem-card__date-content",children:[e.jsx("span",{className:"ordem-card__date-label",children:"In√≠cio"}),e.jsx("span",{className:"ordem-card__date-value",children:j.dataInicio||"--"})]})]}),e.jsxs("div",{className:"ordem-card__date-item",children:[e.jsx("div",{className:"ordem-card__date-icon",children:e.jsx(Oa,{size:18})}),e.jsxs("div",{className:"ordem-card__date-content",children:[e.jsx("span",{className:"ordem-card__date-label",children:"Previs√£o"}),e.jsx("span",{className:"ordem-card__date-value",children:j.dataPrevista||"--"})]})]}),e.jsxs("div",{className:"ordem-card__date-item",children:[e.jsx("div",{className:"ordem-card__date-icon",children:e.jsx(os,{size:18})}),e.jsxs("div",{className:"ordem-card__date-content",children:[e.jsx("span",{className:"ordem-card__date-label",children:"Total"}),e.jsxs("span",{className:"ordem-card__date-value",children:[Y(j)," pe√ßas"]})]})]})]}),e.jsxs("div",{className:"ordem-card__grade-section",children:[e.jsx("h4",{className:"ordem-card__grade-title",children:"Grade de Produ√ß√£o"}),e.jsxs("div",{className:"ordem-card__table",style:{"--tamanhos-count":T.length},children:[e.jsxs("div",{className:"ordem-card__table-header",children:[e.jsx("span",{children:"Cor"}),T.map(B=>e.jsx("span",{children:B.nome},B.id)),e.jsx("span",{children:"Total"})]}),j.grade.map(B=>{const X=B.quantidades||{};return e.jsxs("div",{className:"ordem-card__table-row",children:[e.jsx("span",{children:B.corNome}),T.map(re=>e.jsx("span",{children:X[re.id]||0},re.id)),e.jsx("span",{children:B.total})]},B.corId)})]})]})]})]},j.id)}),V.length===0&&e.jsxs("div",{className:"ordens-empty",children:[e.jsx(_e,{size:24}),'Nenhuma ordem encontrada. Clique em "Nova Ordem" para come√ßar.']})]}),e.jsx(pt,{isOpen:c,onClose:()=>{x(!1),m(null)},onSubmit:b,isSubmitting:f,orderToEdit:p??void 0}),e.jsx(Qe,{isOpen:C,onClose:()=>{q(!1),_(null)},onConfirm:P,itemName:a.find(j=>j.id===F)?.codigo||"",loading:M,title:"Confirmar Exclus√£o",message:"Tem certeza que deseja excluir esta ordem de produ√ß√£o?",confirmText:"Excluir",cancelText:"Cancelar"}),e.jsx(xt,{isOpen:E,onClose:()=>{S(!1),ie(null)},order:$,produto:o.find(j=>j.id===$?.produtoId)})]})},jt=({isOpen:s,onClose:a,order:t,currentStage:o,availableStages:n,faccoes:r,totalPecas:i,onSubmit:l,isSubmitting:u})=>{const[c,x]=d.useState({finalizadas:i,defeituosas:0,proximaEtapaId:"",responsavelProximaEtapaId:"",observacoes:""}),f=async m=>{if(m.preventDefault(),c.finalizadas+c.defeituosas>i){ns.error("O n√∫mero de pe√ßas finalizadas e defeituosas n√£o pode ser maior que o total de pe√ßas");return}if(!p){if(!c.proximaEtapaId){alert("Selecione a pr√≥xima etapa");return}if(!c.responsavelProximaEtapaId){alert("Selecione o respons√°vel pela pr√≥xima etapa");return}}await l(c)},v=()=>{u||(x({finalizadas:i,defeituosas:0,proximaEtapaId:"",responsavelProximaEtapaId:"",observacoes:""}),a())},p=n.length===0;return s?e.jsx("div",{className:"finalize-modal-overlay",children:e.jsxs("div",{className:"finalize-modal",children:[e.jsxs("header",{className:"finalize-modal-header",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"Finalizar Etapa"}),e.jsxs("p",{children:[t.codigo," - ",o.etapaNome]})]}),e.jsx("button",{className:"finalize-modal-close",onClick:v,disabled:u,children:e.jsx(pe,{size:18})})]}),e.jsxs("form",{className:"finalize-modal-form",onSubmit:f,children:[e.jsxs("div",{className:"finalize-form-section",children:[e.jsx("h3",{className:"finalize-section-title",children:"Quantidades"}),e.jsxs("div",{className:"finalize-form-row",children:[e.jsxs("div",{className:"finalize-form-field",children:[e.jsxs("label",{children:["Pe√ßas Finalizadas*",e.jsxs("span",{className:"field-hint",children:["Total: ",i]})]}),e.jsx("input",{type:"number",min:0,max:i,value:c.finalizadas,onChange:m=>x({...c,finalizadas:parseInt(m.target.value)||0}),required:!0,disabled:u})]}),e.jsxs("div",{className:"finalize-form-field",children:[e.jsxs("label",{children:["Pe√ßas Defeituosas*",e.jsx("span",{className:"field-hint",children:"Opcional"})]}),e.jsx("input",{type:"number",min:0,value:c.defeituosas,onChange:m=>x({...c,defeituosas:parseInt(m.target.value)||0}),disabled:u})]})]}),c.finalizadas+c.defeituosas>i&&e.jsxs("div",{className:"finalize-alert",children:[e.jsx(Ye,{size:20}),e.jsxs("span",{children:["A soma n√£o pode ser maior que ",i," pe√ßas"]})]})]}),e.jsxs("div",{className:"finalize-form-section",children:[e.jsx("h3",{className:"finalize-section-title",children:"Pr√≥xima Etapa"}),p?e.jsxs("div",{className:"finalize-alert",children:[e.jsx(Ye,{size:20}),e.jsx("span",{children:"Esta √© a √∫ltima etapa da produ√ß√£o. Ao finalizar, a ordem ser√° conclu√≠da."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"finalize-form-field",children:[e.jsx("label",{children:"Etapa*"}),e.jsxs("div",{className:"finalize-select-wrapper",children:[e.jsxs("select",{value:c.proximaEtapaId,onChange:m=>x({...c,proximaEtapaId:m.target.value}),required:!p,disabled:u||p,children:[e.jsx("option",{value:"",children:"Selecione a etapa"}),n.map(m=>e.jsx("option",{value:m.id,children:m.name},m.id))]}),e.jsx(oa,{size:18,className:"select-icon"})]})]}),e.jsxs("div",{className:"finalize-form-field",children:[e.jsx("label",{children:"Respons√°vel*"}),e.jsxs("div",{className:"finalize-select-wrapper",children:[e.jsxs("select",{value:c.responsavelProximaEtapaId,onChange:m=>x({...c,responsavelProximaEtapaId:m.target.value}),required:!p,disabled:u||p,children:[e.jsx("option",{value:"",children:"Selecione o respons√°vel"}),r.map(m=>e.jsx("option",{value:m.id,children:m.nome},m.id))]}),e.jsx(oa,{size:18,className:"select-icon"})]})]})]})]}),e.jsxs("div",{className:"finalize-form-section",children:[e.jsx("h3",{className:"finalize-section-title",children:"Observa√ß√µes"}),e.jsxs("div",{className:"finalize-form-field",children:[e.jsxs("label",{children:["Problemas ou observa√ß√µes",e.jsx("span",{className:"field-hint",children:"Opcional"})]}),e.jsx("textarea",{rows:4,value:c.observacoes,onChange:m=>x({...c,observacoes:m.target.value}),disabled:u,placeholder:"Descreva problemas encontrados, atrasos, ou outras observa√ß√µes relevantes..."})]})]}),e.jsxs("footer",{className:"finalize-modal-footer",children:[e.jsx("button",{type:"button",className:"finalize-btn finalize-btn-cancel",onClick:v,disabled:u,children:"Cancelar"}),e.jsx("button",{type:"submit",className:"finalize-btn finalize-btn-submit",disabled:u,children:u?"Finalizando...":"Finalizar Etapa"})]})]})]})}):null},gt=()=>{const{user:s}=le(),[a,t]=d.useState([]),[o,n]=d.useState([]),[r,i]=d.useState([]),[l,u]=d.useState(new Map),[c,x]=d.useState(""),[f,v]=d.useState("all"),[p,m]=d.useState(!0),[g,N]=d.useState([]),[C,q]=d.useState(!1),[F,_]=d.useState(null),[M,L]=d.useState(!1),[E,S]=d.useState(!1),[$,ie]=d.useState(null),[h,z]=d.useState(!1),P=d.useCallback(async()=>{if(s)try{m(!0);const[y,A,O,K]=await Promise.all([Pe.getOrders(s.uid),De.getStepsByUser(s.uid),Ce.getFaccoes(),we.getProdutos(s.uid)]);t(y),n(A),N(O);const H=K.map(U=>{const Z=(U.etapasProducaoIds||[]).map(ae=>{const J=A.find(me=>me.id===ae.etapaId);return J?{etapa:{id:J.id,nome:J.name,descricao:J.description||void 0,custo:ae.custo,ativo:!0,createdAt:J.createdAt},custo:ae.custo,ordem:ae.ordem}:null}).filter(ae=>ae!==null);return{...U,etapasProducao:Z}});i(H);const de=new Map;for(const U of y){let Z=await xe.getProgressByOrderId(U.id);if(!Z){const ae=H.find(J=>J.id===U.produtoId);if(ae&&ae.etapasProducao&&ae.etapasProducao.length>0){const J=ae.etapasProducao.map(me=>{const Re=A.find(ve=>ve.id===me.etapa.id);return Re?{...Re,order:me.ordem}:null}).filter(me=>me!==null).sort((me,Re)=>me.order-Re.order);J.length>0&&(await xe.initializeProgress(s.uid,U.id,J),Z=await xe.getProgressByOrderId(U.id))}}Z&&de.set(U.id,Z)}u(de)}catch(y){console.error("Erro ao carregar dados:",y)}finally{m(!1)}},[s]);d.useEffect(()=>{P()},[P]);const w=d.useMemo(()=>{let y=a;if(c.trim()){const A=c.trim().toLowerCase();y=y.filter(O=>O.codigo.toLowerCase().includes(A)||O.produtoDescricao.toLowerCase().includes(A)||O.produtoRef.toLowerCase().includes(A)||O.responsavelNome?.toLowerCase().includes(A))}return f!=="all"&&(y=y.filter(A=>{const O=l.get(A.id);return O?O.etapas.some(K=>K.etapaId===f&&K.status==="em_andamento"):!1})),y},[a,c,f,l]),V=y=>y.grade.reduce((A,O)=>A+O.total,0),Y=y=>{const A=l.get(y);return A?A.etapas.find(O=>O.status==="em_andamento"):null},b=y=>{const A=l.get(y);if(!A)return null;const O=Y(y);return O?A.etapas.find(K=>K.ordem>O.ordem&&K.status!=="finalizada"):A.etapas.find(K=>K.status!=="finalizada")},k=y=>{const A=l.get(y);return A?A.etapas.find(O=>O.status==="pausada"):null},R=y=>{const A=l.get(y);if(!A)return!1;const O=A.etapas.some(H=>H.status==="em_andamento");return A.etapas.some(H=>H.status==="pausada")&&!O},j=y=>{const A=l.get(y);if(!A)return{percent:0,finalizadas:0,defeituosas:0,restantes:0};const O=a.find(ve=>ve.id===y);if(!O)return{percent:0,finalizadas:0,defeituosas:0,restantes:0};const H=r.find(ve=>ve.id===O.produtoId)?.etapasProducao?.length||A.etapas.length,de=A.etapas.filter(ve=>ve.status==="finalizada").length,U=H>0?Math.round(de/H*100):0,Z=V(O),ae=A.etapas.find(ve=>ve.status==="em_andamento");if(!ae){if(A.etapas.every(Je=>Je.status==="finalizada")){const ga=A.etapas[A.etapas.length-1]?.finalizadas||0,va=A.etapas.reduce((qa,Ma)=>qa+(Ma.defeituosas||0),0),Ra=Z-ga-va;return{percent:U,finalizadas:ga,defeituosas:va,restantes:Ra}}return{percent:U,finalizadas:0,defeituosas:0,restantes:Z}}const J=ae.finalizadas||0,me=A.etapas.reduce((ve,Je)=>ve+(Je.defeituosas||0),0),Re=Z-J-me;return{percent:U,finalizadas:J,defeituosas:me,restantes:Re}},I=y=>{_(y),q(!0)},T=async y=>{if(!s||!F)return;const A=l.get(F);if(!A)return;const O=Y(F);if(!O)return;const K=a.find(H=>H.id===F);if(K)try{L(!0),await xe.finalizeStageWithDetails(A.id,O.etapaId,y.finalizadas,y.defeituosas,y.observacoes);const H=r.find(J=>J.id===K.produtoId),de=H?.etapasProducao?.find(J=>J.etapa.id===O.etapaId),U=g.find(J=>J.id===O.responsavelId);if(de&&U&&U.id){const J=new Date;J.setDate(J.getDate()+30),await Ee.createLancamento({ordemProducaoId:K.id,ordemCodigo:K.codigo,produtoId:K.produtoId,produtoDescricao:H?.descricao||"Produto",etapaId:O.etapaId,etapaNome:O.etapaNome,faccaoId:U.id,faccaoNome:U.nome,valor:de.custo,dataVencimento:J,observacoes:y.observacoes||void 0},s.uid)}const Z=o.find(J=>J.id===y.proximaEtapaId),ae=g.find(J=>J.id===y.responsavelProximaEtapaId);Z&&ae&&await xe.startNextStage(A.id,y.proximaEtapaId,y.responsavelProximaEtapaId,ae.nome),await P(),q(!1),_(null),W.success("Etapa finalizada e lan√ßamento financeiro criado!",{icon:e.jsx(ce,{size:20})})}catch(H){console.error("Erro ao finalizar etapa:",H),W.error("Erro ao finalizar etapa")}finally{L(!1)}},B=async y=>{if(!s)return;const A=l.get(y);if(!A)return;const O=Y(y);if(O)try{await xe.pauseStage(A.id,O.etapaId),await P()}catch(K){console.error("Erro ao pausar etapa:",K),alert("Erro ao pausar etapa")}},X=async y=>{if(!s)return;const A=l.get(y);if(!A)return;const O=k(y);if(O)try{await xe.resumeStage(A.id,O.etapaId),await P()}catch(K){console.error("Erro ao retomar etapa:",K),alert("Erro ao retomar etapa")}},re=y=>{ie(y),S(!0)},se=async()=>{if(!(!a.find(A=>A.id===$)||!$))try{z(!0);const A=l.get($);if(A)try{await xe.deleteProgress(A.id)}catch(O){console.error("Erro ao deletar progresso:",O)}try{await Ee.deleteLancamentosByOrdem($)}catch(O){console.error("Erro ao deletar lan√ßamentos financeiros:",O)}await Pe.deleteOrder($),await P(),W.success("Ordem de produ√ß√£o exclu√≠da com sucesso!",{icon:e.jsx(ce,{size:20})})}catch(A){console.error("Erro ao excluir ordem:",A),W.error("Erro ao excluir ordem de produ√ß√£o. Tente novamente.")}};return p?e.jsx("div",{className:"gestao-producoes-container",children:e.jsx("header",{className:"gestao-producoes-header",children:e.jsxs("div",{children:[e.jsx("h2",{className:"gestao-producoes-title",children:"Gest√£o de Produ√ß√£o"}),e.jsx("p",{className:"gestao-producoes-subtitle",children:"Carregando dados..."})]})})}):e.jsxs("div",{className:"gestao-producoes-container",children:[e.jsx("header",{className:"gestao-producoes-header",children:e.jsxs("div",{children:[e.jsx("h2",{className:"gestao-producoes-title",children:"Gest√£o de Produ√ß√£o"}),e.jsx("p",{className:"gestao-producoes-subtitle",children:"Controle o andamento das ordens de produ√ß√£o em tempo real"})]})}),e.jsxs("div",{className:"gestao-producoes-filters",children:[e.jsxs("div",{className:"gestao-producoes-search",children:[e.jsx(_e,{size:18}),e.jsx("input",{type:"text",placeholder:"Buscar por OP, produto ou refer√™ncia...",value:c,onChange:y=>x(y.target.value)})]}),e.jsxs("div",{className:"gestao-producoes-stage-filter",children:[e.jsxs("select",{value:f,onChange:y=>v(y.target.value),children:[e.jsx("option",{value:"all",children:"Todas as Etapas"}),o.map(y=>e.jsx("option",{value:y.id,children:y.name},y.id))]}),e.jsx(oa,{size:18,className:"select-icon"})]})]}),e.jsxs("section",{className:"gestao-producoes-list",children:[w.map(y=>{const A=Y(y.id),O=k(y.id),K=b(y.id),H=j(y.id),de=V(y),U=R(y.id),Z=A||O;return e.jsxs("article",{className:"gestao-producao-card",children:[e.jsxs("div",{className:"gestao-card-header",children:[e.jsxs("div",{className:"gestao-card-header-left",children:[e.jsx("div",{className:"gestao-card-icon",children:e.jsx(is,{size:24})}),e.jsxs("div",{className:"gestao-card-info",children:[e.jsx("div",{className:"gestao-card-op",children:y.codigo}),e.jsx("h3",{className:"gestao-card-title",children:y.produtoDescricao}),e.jsxs("div",{className:"gestao-card-meta",children:[e.jsxs("span",{children:["REF: ",y.produtoRef]}),e.jsxs("span",{className:"gestao-card-pieces",children:[de," pe√ßas"]})]})]})]}),e.jsxs("div",{className:"gestao-card-header-right",children:[e.jsx("span",{className:`gestao-badge gestao-badge-status ${U?"gestao-badge-paused":""}`,children:U?"Pausada":"Em Andamento"}),Z&&e.jsx("span",{className:"gestao-badge gestao-badge-stage",children:Z.etapaNome})]})]}),Z&&e.jsxs("div",{className:"gestao-card-progress",children:[e.jsxs("div",{className:"progress-header",children:[e.jsx("span",{className:"progress-title",children:"Progresso Geral"}),e.jsxs("span",{className:"progress-percent",children:[H.percent,"%"]})]}),e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-bar-fill",style:{width:`${H.percent}%`}})}),e.jsxs("div",{className:"progress-stats",children:[e.jsxs("span",{className:"progress-stat",children:[H.finalizadas," pe√ßas finalizadas"]}),e.jsxs("span",{className:"progress-stat",children:[H.defeituosas," defeituosas"]}),e.jsxs("span",{className:"progress-stat",children:[H.restantes," restantes"]})]})]}),e.jsxs("div",{className:"gestao-card-details",children:[e.jsxs("div",{className:"detail-item",children:[e.jsx(cs,{size:16,className:"detail-icon"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"Respons√°vel"}),e.jsx("span",{className:"detail-value",children:Z?.responsavelNome||y.responsavelNome||"N√£o atribu√≠do"})]})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx(Fe,{size:16,className:"detail-icon"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"Iniciado em"}),e.jsx("span",{className:"detail-value",children:y.dataInicio||"--"})]})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx(ds,{size:16,className:"detail-icon"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"Pr√≥xima Etapa"}),e.jsx("span",{className:"detail-value",children:K?.etapaNome||"Conclu√≠da"})]})]})]}),e.jsxs("div",{className:"gestao-card-actions",children:[U?e.jsxs("button",{className:"gestao-action-btn gestao-action-resume",onClick:()=>X(y.id),children:[e.jsx(ls,{size:16,className:"gestao-action-icon"}),"Retomar Produ√ß√£o"]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"gestao-action-btn gestao-action-finish",onClick:()=>I(y.id),disabled:!A||A.status!=="em_andamento",children:[e.jsx(ce,{size:16,className:"gestao-action-icon"}),"Finalizar Etapa"]}),e.jsxs("button",{className:"gestao-action-btn gestao-action-pause",onClick:()=>B(y.id),disabled:!A||A.status!=="em_andamento",children:[e.jsx(ms,{size:16,className:"gestao-action-icon"}),"Pausar"]})]}),e.jsxs("button",{className:"gestao-action-btn gestao-action-report",children:[e.jsx(Fa,{size:16,className:"gestao-action-icon"}),"Reportar Problema"]}),e.jsxs("button",{className:"gestao-action-btn gestao-action-delete",onClick:()=>re(y.id),title:"Excluir ordem",children:[e.jsx(Le,{size:16,className:"gestao-action-icon"}),"Excluir"]})]})]},y.id)}),w.length===0&&e.jsxs("div",{className:"gestao-producoes-empty",children:[e.jsx(_e,{size:24}),e.jsx("p",{children:"Nenhuma ordem de produ√ß√£o encontrada."})]})]}),C&&F&&(()=>{const y=a.find(U=>U.id===F),A=Y(F),O=l.get(F);if(!y||!A||!O)return null;const de=(r.find(U=>U.id===y.produtoId)?.etapasProducao||[]).filter(U=>{const Z=O.etapas.find(ae=>ae.etapaId===U.etapa.id);return Z?Z.ordem>A.ordem:!1}).map(U=>{const Z=o.find(ae=>ae.id===U.etapa.id);return Z?{...Z,name:U.etapa.nome,description:U.etapa.descricao||""}:null}).filter(U=>U!==null).sort((U,Z)=>{const ae=O.etapas.find(me=>me.etapaId===U.id)?.ordem||0,J=O.etapas.find(me=>me.etapaId===Z.id)?.ordem||0;return ae-J});return e.jsx(jt,{isOpen:C,onClose:()=>{q(!1),_(null)},order:y,currentStage:A,availableStages:de,faccoes:g.filter(U=>U.ativo),totalPecas:V(y),onSubmit:T,isSubmitting:M})})(),e.jsx(Qe,{isOpen:E,onClose:()=>{S(!1),ie(null)},onConfirm:se,itemName:a.find(y=>y.id===$)?.codigo||"",loading:h,title:"Confirmar Exclus√£o",message:"Tem certeza que deseja excluir esta ordem de produ√ß√£o?",confirmText:"Excluir",cancelText:"Cancelar"})]})},vt=({isOpen:s,onClose:a,lancamento:t,empresaNome:o="Empresa"})=>{const n=d.useRef(null),r=()=>{window.print()},i=x=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(x),l=x=>new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(x),u=x=>new Intl.DateTimeFormat("pt-BR",{day:"numeric",month:"long",year:"numeric"}).format(x),c=x=>{const f=["","um","dois","tr√™s","quatro","cinco","seis","sete","oito","nove"],v=["","dez","vinte","trinta","quarenta","cinquenta","sessenta","setenta","oitenta","noventa"],p=["dez","onze","doze","treze","quatorze","quinze","dezesseis","dezessete","dezoito","dezenove"],m=["","cento","duzentos","trezentos","quatrocentos","quinhentos","seiscentos","setecentos","oitocentos","novecentos"],g=Math.floor(x),N=Math.round((x-g)*100),C=_=>{if(_===0)return"";if(_===100)return"cem";const M=Math.floor(_/100),L=Math.floor(_%100/10),E=_%10;let S=m[M];return L===1?S+=(S?" e ":"")+p[E]:(L>0&&(S+=(S?" e ":"")+v[L]),E>0&&(S+=(S?" e ":"")+f[E])),S};let F=(_=>{if(_===0)return"zero";const M=Math.floor(_/1e3),L=_%1e3;let E="";return M>0&&(M===1?E="mil":E=C(M)+" mil"),L>0&&(E+=(E?" e ":"")+C(L)),E})(g);return F+=g===1?" real":" reais",N>0&&(F+=" e "+C(N),F+=N===1?" centavo":" centavos"),F};return s?e.jsx("div",{className:"receipt-modal-overlay",children:e.jsxs("div",{className:"receipt-modal",children:[e.jsxs("div",{className:"receipt-modal-header no-print",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"Recibo de Pagamento"}),e.jsx("p",{children:"Visualize antes de imprimir"})]}),e.jsxs("div",{className:"receipt-modal-actions",children:[e.jsxs("button",{className:"btn-print",onClick:r,children:[e.jsx(da,{size:18}),"Imprimir"]}),e.jsx("button",{className:"btn-close",onClick:a,children:e.jsx(pe,{size:18})})]})]}),e.jsx("div",{className:"receipt-modal-content",ref:n,children:e.jsxs("div",{className:"receipt-page",children:[e.jsxs("div",{className:"receipt-header",children:[e.jsx("div",{className:"receipt-company-name",children:o}),e.jsx("div",{className:"receipt-title",children:"RECIBO DE PAGAMENTO"}),e.jsxs("div",{className:"receipt-number",children:["N¬∫ ",t.id.substring(0,8).toUpperCase()]})]}),e.jsxs("div",{className:"receipt-value-box",children:[e.jsx("span",{className:"receipt-value-label",children:"VALOR:"}),e.jsx("span",{className:"receipt-value",children:i(t.valor)})]}),e.jsxs("div",{className:"receipt-body",children:[e.jsx("div",{className:"receipt-text-section",children:e.jsxs("p",{className:"receipt-main-text",children:["Recebi de ",e.jsx("strong",{children:o})," a quantia de"," ",e.jsx("strong",{children:i(t.valor)})," (",c(t.valor),"), referente ao pagamento de servi√ßos prestados conforme especificado abaixo:"]})}),e.jsxs("div",{className:"receipt-details-section",children:[e.jsx("h3",{className:"receipt-details-title",children:"Detalhes do Servi√ßo"}),e.jsxs("div",{className:"receipt-details-grid",children:[e.jsxs("div",{className:"receipt-detail-item",children:[e.jsx("span",{className:"receipt-detail-label",children:"Ordem de Produ√ß√£o:"}),e.jsx("span",{className:"receipt-detail-value",children:t.ordemCodigo})]}),e.jsxs("div",{className:"receipt-detail-item",children:[e.jsx("span",{className:"receipt-detail-label",children:"Produto:"}),e.jsx("span",{className:"receipt-detail-value",children:t.produtoDescricao})]}),e.jsxs("div",{className:"receipt-detail-item",children:[e.jsx("span",{className:"receipt-detail-label",children:"Etapa Realizada:"}),e.jsx("span",{className:"receipt-detail-value",children:t.etapaNome})]}),e.jsxs("div",{className:"receipt-detail-item",children:[e.jsx("span",{className:"receipt-detail-label",children:"Prestador de Servi√ßo:"}),e.jsx("span",{className:"receipt-detail-value",children:t.faccaoNome})]}),e.jsxs("div",{className:"receipt-detail-item",children:[e.jsx("span",{className:"receipt-detail-label",children:"Data de Vencimento:"}),e.jsx("span",{className:"receipt-detail-value",children:l(t.dataVencimento)})]}),e.jsxs("div",{className:"receipt-detail-item",children:[e.jsx("span",{className:"receipt-detail-label",children:"Data de Pagamento:"}),e.jsx("span",{className:"receipt-detail-value",children:t.dataPagamento?l(t.dataPagamento):"-"})]})]})]}),t.observacoes&&e.jsxs("div",{className:"receipt-observations-section",children:[e.jsx("h3",{className:"receipt-details-title",children:"Observa√ß√µes"}),e.jsx("p",{className:"receipt-observation-text",children:t.observacoes})]}),e.jsx("div",{className:"receipt-extenso-section",children:e.jsxs("p",{className:"receipt-extenso-text",children:["( ",c(t.valor)," )"]})})]}),e.jsx("div",{className:"receipt-date-location",children:e.jsxs("p",{children:[o,","," ",t.dataPagamento?u(t.dataPagamento):u(new Date),"."]})}),e.jsxs("div",{className:"receipt-signatures",children:[e.jsxs("div",{className:"receipt-signature-box",children:[e.jsx("div",{className:"receipt-signature-line"}),e.jsxs("div",{className:"receipt-signature-info",children:[e.jsx("p",{className:"receipt-signature-name",children:t.faccaoNome}),e.jsx("p",{className:"receipt-signature-label",children:"Assinatura do Prestador de Servi√ßo"})]})]}),e.jsxs("div",{className:"receipt-signature-box",children:[e.jsx("div",{className:"receipt-signature-line"}),e.jsxs("div",{className:"receipt-signature-info",children:[e.jsx("p",{className:"receipt-signature-name",children:o}),e.jsx("p",{className:"receipt-signature-label",children:"Assinatura do Pagador"})]})]})]}),e.jsxs("div",{className:"receipt-footer",children:[e.jsx("p",{className:"receipt-footer-text",children:"Este recibo tem validade como comprovante de pagamento."}),e.jsxs("p",{className:"receipt-footer-info",children:["Documento gerado em ",new Date().toLocaleString("pt-BR")," - ID:"," ",t.id]})]})]})})]})}):null},Nt=()=>{const{user:s}=le(),[a,t]=d.useState("pendencias"),[o,n]=d.useState(""),[r,i]=d.useState("todos"),[l,u]=d.useState([]),[c,x]=d.useState([]),[f,v]=d.useState(!0),[p,m]=d.useState(!1),[g,N]=d.useState(null),C=d.useRef(!1),q=d.useCallback(async()=>{if(s)try{v(!0);const[h,z]=await Promise.all([Ee.getLancamentosPendentes(s.uid),Ee.getLancamentosPagos(s.uid)]);u(h),x(z)}catch(h){console.error("Erro ao carregar lan√ßamentos:",h),W.error("Erro ao carregar dados financeiros")}finally{v(!1)}},[s]);d.useEffect(()=>{C.current||(C.current=!0,q())},[q]);const F=h=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(h),_=h=>new Intl.DateTimeFormat("pt-BR").format(new Date(h)),M=h=>{const z=new Date;z.setHours(0,0,0,0);const P=new Date(h);P.setHours(0,0,0,0);const w=z.getTime()-P.getTime();return Math.floor(w/(1e3*60*60*24))},L={totalPendente:l.filter(h=>h.status==="pendente").reduce((h,z)=>h+z.valor,0),totalAtrasado:l.filter(h=>h.status==="atrasado").reduce((h,z)=>h+z.valor,0),totalPagoMes:c.filter(h=>{const z=new Date(h.dataPagamento),P=new Date().getMonth(),w=new Date().getFullYear();return z.getMonth()===P&&z.getFullYear()===w}).reduce((h,z)=>h+z.valor,0),lancamentosPendentes:l.filter(h=>h.status==="pendente").length,lancamentosAtrasados:l.filter(h=>h.status==="atrasado").length,pagamentosMes:c.filter(h=>{const z=new Date(h.dataPagamento),P=new Date().getMonth(),w=new Date().getFullYear();return z.getMonth()===P&&z.getFullYear()===w}).length},E=l.filter(h=>{const z=h.ordemCodigo.toLowerCase().includes(o.toLowerCase())||h.faccaoNome.toLowerCase().includes(o.toLowerCase())||h.produtoDescricao.toLowerCase().includes(o.toLowerCase()),P=r==="todos"||h.status===r;return z&&P}),S=c.filter(h=>h.ordemCodigo.toLowerCase().includes(o.toLowerCase())||h.faccaoNome.toLowerCase().includes(o.toLowerCase())||h.produtoDescricao.toLowerCase().includes(o.toLowerCase())),$=async h=>{if(window.confirm("Confirmar pagamento deste lan√ßamento?"))try{await Ee.marcarComoPago(h),await q(),W.success("Pagamento registrado com sucesso!",{icon:e.jsx(Xe,{size:20})});const z=await Ee.getLancamentoById(h);z&&(N(z),m(!0))}catch(z){console.error("Erro ao registrar pagamento:",z),W.error("Erro ao registrar pagamento")}},ie=h=>{N(h),m(!0)};return f?e.jsx("div",{className:"financeiro-container",children:e.jsx("div",{className:"financeiro-loading",children:"Carregando..."})}):e.jsxs("div",{className:"financeiro-container",children:[e.jsxs("div",{className:"financeiro-header",children:[e.jsxs("div",{className:"financeiro-header-title",children:[e.jsx("h2",{className:"financeiro-title",children:"Financeiro"}),e.jsx("p",{className:"financeiro-subtitle",children:"Controle de pagamentos e pend√™ncias financeiras"})]}),e.jsxs("button",{className:"financeiro-export-btn",children:[e.jsx(ha,{size:18}),e.jsx("span",{children:"Exportar Relat√≥rio"})]})]}),e.jsxs("div",{className:"financeiro-summary-grid",children:[e.jsxs("div",{className:"financeiro-card",children:[e.jsxs("div",{className:"financeiro-card-header",children:[e.jsx("span",{className:"financeiro-card-title",children:"Total Pendente"}),e.jsx("div",{className:"financeiro-card-icon financeiro-icon-orange",children:e.jsx(Fe,{size:20})})]}),e.jsx("div",{className:"financeiro-card-value financeiro-value-orange",children:F(L.totalPendente)}),e.jsxs("div",{className:"financeiro-card-sub",children:[L.lancamentosPendentes," lan√ßamentos"]})]}),e.jsxs("div",{className:"financeiro-card",children:[e.jsxs("div",{className:"financeiro-card-header",children:[e.jsx("span",{className:"financeiro-card-title",children:"Total Atrasado"}),e.jsx("div",{className:"financeiro-card-icon financeiro-icon-red",children:e.jsx(Ye,{size:20})})]}),e.jsx("div",{className:"financeiro-card-value financeiro-value-red",children:F(L.totalAtrasado)}),e.jsxs("div",{className:"financeiro-card-sub",children:[L.lancamentosAtrasados," em atraso"]})]}),e.jsxs("div",{className:"financeiro-card",children:[e.jsxs("div",{className:"financeiro-card-header",children:[e.jsx("span",{className:"financeiro-card-title",children:"Total Pago (M√™s)"}),e.jsx("div",{className:"financeiro-card-icon financeiro-icon-green",children:e.jsx(Xe,{size:20})})]}),e.jsx("div",{className:"financeiro-card-value financeiro-value-green",children:F(L.totalPagoMes)}),e.jsxs("div",{className:"financeiro-card-sub",children:[L.pagamentosMes," pagamentos"]})]}),e.jsxs("div",{className:"financeiro-card",children:[e.jsxs("div",{className:"financeiro-card-header",children:[e.jsx("span",{className:"financeiro-card-title",children:"Total Geral"}),e.jsx("div",{className:"financeiro-card-icon financeiro-icon-blue",children:e.jsx(Be,{size:20})})]}),e.jsx("div",{className:"financeiro-card-value financeiro-value-gray",children:F(L.totalPendente+L.totalAtrasado)}),e.jsxs("div",{className:"financeiro-card-sub",children:[L.lancamentosPendentes+L.lancamentosAtrasados," ","pendentes"]})]})]}),e.jsxs("div",{className:"financeiro-search-section",children:[e.jsxs("div",{className:"financeiro-search-bar",children:[e.jsx(_e,{size:18,className:"financeiro-search-icon"}),e.jsx("input",{type:"text",placeholder:"Buscar por OP, fac√ß√£o ou produto...",value:o,onChange:h=>n(h.target.value),className:"financeiro-search-input"})]}),a==="pendencias"&&e.jsx("div",{className:"financeiro-status-filter",children:e.jsxs("select",{value:r,onChange:h=>i(h.target.value),className:"financeiro-status-select",children:[e.jsx("option",{value:"todos",children:"Todos os Status"}),e.jsx("option",{value:"pendente",children:"Pendente"}),e.jsx("option",{value:"atrasado",children:"Atrasado"})]})})]}),e.jsxs("div",{className:"financeiro-nav-tabs",children:[e.jsx("button",{className:`financeiro-nav-tab ${a==="pendencias"?"active":""}`,onClick:()=>t("pendencias"),children:"Pend√™ncias"}),e.jsx("button",{className:`financeiro-nav-tab ${a==="pagamentos"?"active":""}`,onClick:()=>t("pagamentos"),children:"Pagamentos Realizados"})]}),e.jsxs("div",{className:"financeiro-content-card",children:[e.jsx("div",{className:"financeiro-content-header",children:e.jsxs("div",{className:"financeiro-content-title-section",children:[e.jsx(ca,{className:"financeiro-dollar-icon",size:24}),e.jsxs("div",{children:[e.jsx("h3",{className:"financeiro-content-title",children:a==="pendencias"?"Pend√™ncias Financeiras":"Pagamentos Realizados"}),e.jsx("p",{className:"financeiro-content-subtitle",children:a==="pendencias"?"Acompanhe os pagamentos pendentes por etapa de produ√ß√£o":"Hist√≥rico de pagamentos realizados"})]})]})}),e.jsx("div",{className:"financeiro-table-container",children:a==="pendencias"?e.jsxs("table",{className:"financeiro-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ordem"}),e.jsx("th",{children:"Fac√ß√£o"}),e.jsx("th",{children:"Etapa"}),e.jsx("th",{children:"Produto"}),e.jsx("th",{children:"Valor"}),e.jsx("th",{children:"Vencimento"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"A√ß√µes"})]})}),e.jsx("tbody",{children:E.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"financeiro-empty-state",children:"Nenhuma pend√™ncia encontrada"})}):E.map(h=>e.jsxs("tr",{children:[e.jsx("td",{children:h.ordemCodigo}),e.jsx("td",{children:h.faccaoNome}),e.jsx("td",{children:e.jsx("span",{className:"financeiro-badge financeiro-badge-default",children:h.etapaNome})}),e.jsx("td",{children:h.produtoDescricao}),e.jsx("td",{className:"financeiro-cell-value",children:F(h.valor)}),e.jsx("td",{children:_(h.dataVencimento)}),e.jsx("td",{children:e.jsx("span",{className:`financeiro-badge ${h.status==="atrasado"?"financeiro-badge-danger":"financeiro-badge-default"}`,children:h.status==="atrasado"?e.jsxs(e.Fragment,{children:[e.jsx(Ye,{size:14}),"Atrasado (",M(h.dataVencimento),"d)"]}):e.jsxs(e.Fragment,{children:[e.jsx(Fe,{size:14}),"Pendente"]})})}),e.jsx("td",{children:e.jsxs("button",{className:"financeiro-action-btn",onClick:()=>$(h.id),children:[e.jsx(us,{size:14}),"Pagar"]})})]},h.id))})]}):e.jsx(e.Fragment,{children:S.length===0?e.jsxs("div",{className:"financeiro-empty-state-large",children:[e.jsx(Xe,{size:48,className:"financeiro-empty-icon"}),e.jsx("p",{children:"Nenhum pagamento realizado ainda"}),e.jsx("p",{className:"financeiro-empty-subtitle",children:"Os pagamentos realizados aparecer√£o aqui"})]}):e.jsxs("table",{className:"financeiro-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ordem"}),e.jsx("th",{children:"Fac√ß√£o"}),e.jsx("th",{children:"Etapa"}),e.jsx("th",{children:"Produto"}),e.jsx("th",{children:"Valor"}),e.jsx("th",{children:"Vencimento"}),e.jsx("th",{children:"Data Pagamento"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"A√ß√µes"})]})}),e.jsx("tbody",{children:S.map(h=>e.jsxs("tr",{children:[e.jsx("td",{children:h.ordemCodigo}),e.jsx("td",{children:h.faccaoNome}),e.jsx("td",{children:e.jsx("span",{className:"financeiro-badge financeiro-badge-default",children:h.etapaNome})}),e.jsx("td",{children:h.produtoDescricao}),e.jsx("td",{className:"financeiro-cell-value",children:F(h.valor)}),e.jsx("td",{children:_(h.dataVencimento)}),e.jsx("td",{children:h.dataPagamento?_(h.dataPagamento):"-"}),e.jsx("td",{children:e.jsxs("span",{className:"financeiro-badge financeiro-badge-success",children:[e.jsx(Xe,{size:14}),"Pago"]})}),e.jsx("td",{children:e.jsxs("button",{className:"financeiro-action-btn financeiro-action-print",onClick:()=>ie(h),title:"Imprimir recibo",children:[e.jsx(da,{size:14}),"Recibo"]})})]},h.id))})]})})})]}),e.jsx(vt,{isOpen:p,onClose:()=>{m(!1),N(null)},lancamento:g,empresaNome:s?.name||"Empresa"})]})},bt=()=>{const{user:s}=le(),[a,t]=d.useState("producao"),[o,n]=d.useState("mes"),[r,i]=d.useState(!0),[l,u]=d.useState([]),[c,x]=d.useState([]),[f,v]=d.useState([]),[p,m]=d.useState({totalOrdens:0,ordensConcluidas:0,ordensEmAndamento:0,taxaConclusao:0,tempoMedioPorEtapa:0}),[g,N]=d.useState([]),C=d.useCallback((P,w)=>{const V=_(o),Y=P.filter(B=>new Date(B.createdAt)>=V),b=Y.filter(B=>B.status==="concluida").length,k=Y.filter(B=>B.status==="em_producao").length,R=Y.length>0?b/Y.length*100:0;let j=0,I=0;w.forEach(B=>{B.etapas.forEach(X=>{if(X.dataInicio&&X.dataFim){const re=new Date(X.dataInicio),se=new Date(X.dataFim),y=Math.ceil((se.getTime()-re.getTime())/(1e3*60*60*24));j+=y,I++}})});const T=I>0?j/I:0;m({totalOrdens:Y.length,ordensConcluidas:b,ordensEmAndamento:k,taxaConclusao:R,tempoMedioPorEtapa:T})},[o]),q=d.useCallback((P,w)=>{const V=new Map;P.forEach(b=>{b.etapas.forEach(k=>{if(k.responsavelId&&k.status==="finalizada"){const R=V.get(k.responsavelId)||{finalizadas:0,diasTotal:0,defeitos:0};if(R.finalizadas++,R.defeitos+=k.defeituosas||0,k.dataInicio&&k.dataFim){const j=new Date(k.dataInicio),I=new Date(k.dataFim),T=Math.ceil((I.getTime()-j.getTime())/(1e3*60*60*24));R.diasTotal+=T}V.set(k.responsavelId,R)}})});const Y=[];V.forEach((b,k)=>{const R=w.find(j=>j.id===k);R&&Y.push({faccaoNome:R.nome,ordensFinalizadas:b.finalizadas,tempoMedio:b.finalizadas>0?b.diasTotal/b.finalizadas:0,taxaDefeitos:b.finalizadas>0?b.defeitos/b.finalizadas*100:0})}),N(Y.sort((b,k)=>k.ordensFinalizadas-b.ordensFinalizadas))},[]),F=d.useCallback(async()=>{if(s)try{i(!0);const[P,w,V,Y]=await Promise.all([Pe.getOrders(s.uid),we.getProdutos(s.uid),Ce.getFaccoes(),xe.getAllProgress(s.uid)]);u(P),x(w),v(V),C(P,Y),q(Y,V)}catch(P){console.error("Erro ao carregar dados:",P)}finally{i(!1)}},[s,C,q]);d.useEffect(()=>{F()},[F,o]);const _=P=>{const w=new Date;switch(P){case"semana":return new Date(w.getTime()-10080*60*1e3);case"mes":return new Date(w.getTime()-720*60*60*1e3);case"trimestre":return new Date(w.getTime()-2160*60*60*1e3);case"ano":return new Date(w.getTime()-365*24*60*60*1e3);default:return new Date(w.getTime()-720*60*60*1e3)}},M=P=>{switch(P){case"semana":return"√öltima Semana";case"mes":return"√öltimo M√™s";case"trimestre":return"√öltimo Trimestre";case"ano":return"√öltimo Ano";default:return"√öltimo M√™s"}},L=P=>new Intl.DateTimeFormat("pt-BR").format(P),E=(P,w=0)=>new Intl.NumberFormat("pt-BR",{minimumFractionDigits:w,maximumFractionDigits:w}).format(P),S=P=>{const w=window.open("","_blank","noopener,noreferrer");if(!w){alert("N√£o foi poss√≠vel abrir a janela de impress√£o.");return}w.document.open(),w.document.write(P),w.document.close(),w.focus(),w.onload=()=>{w.print()}},$=(P,w,V)=>`<!DOCTYPE html>
      <html lang="pt-BR">
        <head>
          <meta charset="utf-8" />
          <meta name="viewport" content="width=device-width, initial-scale=1" />
          <title>${P}</title>
          <style>
            @page { size: A4; margin: 18mm; }
            * { box-sizing: border-box; }
            body { font-family: "Segoe UI", Arial, sans-serif; color: #0f172a; }
            h1 { font-size: 20px; margin: 0 0 4px 0; }
            h2 { font-size: 14px; margin: 0 0 16px 0; color: #475569; font-weight: 600; }
            .meta { font-size: 12px; color: #64748b; margin-bottom: 16px; }
            .section { margin: 18px 0; }
            .section-title { font-size: 14px; font-weight: 700; margin-bottom: 10px; }
            .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
            .card { border: 1px solid #e2e8f0; border-radius: 8px; padding: 10px; }
            .card-label { font-size: 11px; color: #64748b; }
            .card-value { font-size: 16px; font-weight: 700; }
            table { width: 100%; border-collapse: collapse; margin-top: 8px; }
            th, td { border: 1px solid #e2e8f0; padding: 8px; font-size: 12px; text-align: left; }
            th { background: #f8fafc; font-weight: 700; }
            .muted { color: #64748b; }
          </style>
        </head>
        <body>
          <h1>${P}</h1>
          <h2>${w}</h2>
          <div class="meta">Gerado em ${L(new Date)}</div>
          ${V}
        </body>
      </html>`,ie=()=>{const P=_(o),w=l.filter(T=>new Date(T.createdAt)>=P),V=w.filter(T=>T.status==="concluida").length,Y=w.filter(T=>T.status==="em_producao").length,b=w.filter(T=>T.status==="planejada").length,k=w.length>0?V/w.length*100:0,R=z(w),j=`
      <div class="section">
        <div class="section-title">Resumo</div>
        <div class="grid">
          <div class="card"><div class="card-label">Total de Ordens</div><div class="card-value">${E(w.length)}</div></div>
          <div class="card"><div class="card-label">Conclu√≠das</div><div class="card-value">${E(V)}</div></div>
          <div class="card"><div class="card-label">Em Andamento</div><div class="card-value">${E(Y)}</div></div>
          <div class="card"><div class="card-label">Planejadas</div><div class="card-value">${E(b)}</div></div>
          <div class="card"><div class="card-label">Taxa de Conclus√£o</div><div class="card-value">${E(k,1)}%</div></div>
          <div class="card"><div class="card-label">Tempo M√©dio por Etapa</div><div class="card-value">${E(p.tempoMedioPorEtapa,1)} dias</div></div>
        </div>
      </div>
      <div class="section">
        <div class="section-title">Top 5 Produtos Mais Produzidos</div>
        <table>
          <thead>
            <tr>
              <th>Produto</th>
              <th>Quantidade de Ordens</th>
            </tr>
          </thead>
          <tbody>
            ${R.map(T=>`
              <tr>
                <td>${T.nome}</td>
                <td>${E(T.quantidade)}</td>
              </tr>`).join("")}
            ${R.length===0?'<tr><td colspan="2" class="muted">Sem dados para o per√≠odo</td></tr>':""}
          </tbody>
        </table>
      </div>
    `,I=$("Relat√≥rio de Produ√ß√£o",`Per√≠odo: ${M(o)}`,j);S(I)},h=()=>{const P=f.filter(b=>b.ativo).length,w=g.slice(0,5),V=`
      <div class="section">
        <div class="section-title">Indicadores Gerais</div>
        <div class="grid">
          <div class="card"><div class="card-label">Fac√ß√µes Ativas</div><div class="card-value">${E(P)}</div></div>
          <div class="card"><div class="card-label">Fac√ß√µes Cadastradas</div><div class="card-value">${E(f.length)}</div></div>
          <div class="card"><div class="card-label">Produtos Cadastrados</div><div class="card-value">${E(c.length)}</div></div>
        </div>
      </div>
      <div class="section">
        <div class="section-title">Fac√ß√µes Mais Produtivas</div>
        <table>
          <thead>
            <tr>
              <th>Fac√ß√£o</th>
              <th>Ordens Finalizadas</th>
              <th>Tempo M√©dio (dias)</th>
              <th>Taxa de Defeitos</th>
            </tr>
          </thead>
          <tbody>
            ${w.map(b=>`
              <tr>
                <td>${b.faccaoNome}</td>
                <td>${E(b.ordensFinalizadas)}</td>
                <td>${E(b.tempoMedio,1)}</td>
                <td>${E(b.taxaDefeitos,1)}%</td>
              </tr>`).join("")}
            ${w.length===0?'<tr><td colspan="4" class="muted">Sem dados de performance</td></tr>':""}
          </tbody>
        </table>
      </div>
    `,Y=$("Relat√≥rio de Performance","Resumo de Fac√ß√µes e Produtos",V);S(Y)},z=(P=l)=>{const w=new Map;return P.forEach(V=>{const Y=w.get(V.produtoDescricao)||0;w.set(V.produtoDescricao,Y+1)}),Array.from(w.entries()).map(([V,Y])=>({nome:V,quantidade:Y})).sort((V,Y)=>Y.quantidade-V.quantidade).slice(0,5)};return r?e.jsxs("div",{className:"relatorios-loading",children:[e.jsx(ya,{size:48,className:"loading-icon"}),e.jsx("p",{children:"Carregando relat√≥rios..."})]}):e.jsxs("div",{className:"tab-content",children:[e.jsxs("div",{className:"tab-header",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"tab-title",children:"Relat√≥rios"}),e.jsx("p",{className:"tab-subtitle",children:"An√°lises e m√©tricas detalhadas do seu sistema"})]}),e.jsxs("div",{className:"relatorios-actions",children:[e.jsxs("button",{className:"btn-export",onClick:ie,children:[e.jsx(ha,{size:18}),"Exportar Produ√ß√£o (PDF)"]}),e.jsxs("button",{className:"btn-export btn-export-secondary",onClick:h,children:[e.jsx(ha,{size:18}),"Exportar Performance (PDF)"]})]})]}),e.jsx("div",{className:"relatorios-filters",children:e.jsxs("div",{className:"filter-group",children:[e.jsx(hs,{size:18}),e.jsx("span",{children:"Per√≠odo:"}),e.jsxs("select",{value:o,onChange:P=>n(P.target.value),className:"filter-select",children:[e.jsx("option",{value:"semana",children:"√öltima Semana"}),e.jsx("option",{value:"mes",children:"√öltimo M√™s"}),e.jsx("option",{value:"trimestre",children:"√öltimo Trimestre"}),e.jsx("option",{value:"ano",children:"√öltimo Ano"})]})]})}),e.jsxs("div",{className:"relatorios-tabs",children:[e.jsxs("button",{className:`relatorio-tab ${a==="producao"?"active":""}`,onClick:()=>t("producao"),children:[e.jsx(ka,{size:20}),"Produ√ß√£o"]}),e.jsxs("button",{className:`relatorio-tab ${a==="performance"?"active":""}`,onClick:()=>t("performance"),children:[e.jsx(Be,{size:20}),"Performance"]})]}),e.jsxs("div",{className:"relatorios-content",children:[a==="producao"&&e.jsxs("div",{className:"relatorio-section",children:[e.jsx("h3",{className:"section-title",children:"Relat√≥rio de Produ√ß√£o"}),e.jsxs("div",{className:"metrics-grid",children:[e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon blue",children:e.jsx(ze,{size:24})}),e.jsxs("div",{className:"metric-info",children:[e.jsx("span",{className:"metric-label",children:"Total de Ordens"}),e.jsx("span",{className:"metric-value",children:p.totalOrdens})]})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon green",children:e.jsx(Be,{size:24})}),e.jsxs("div",{className:"metric-info",children:[e.jsx("span",{className:"metric-label",children:"Conclu√≠das"}),e.jsx("span",{className:"metric-value",children:p.ordensConcluidas})]})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon orange",children:e.jsx(ya,{size:24})}),e.jsxs("div",{className:"metric-info",children:[e.jsx("span",{className:"metric-label",children:"Em Andamento"}),e.jsx("span",{className:"metric-value",children:p.ordensEmAndamento})]})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon purple",children:e.jsx(ps,{size:24})}),e.jsxs("div",{className:"metric-info",children:[e.jsx("span",{className:"metric-label",children:"Taxa de Conclus√£o"}),e.jsxs("span",{className:"metric-value",children:[p.taxaConclusao.toFixed(1),"%"]})]})]})]}),e.jsxs("div",{className:"chart-container",children:[e.jsx("h4",{className:"chart-title",children:"Distribui√ß√£o de Status"}),e.jsxs("div",{className:"bar-chart",children:[e.jsxs("div",{className:"bar-item",children:[e.jsx("div",{className:"bar-label",children:"Conclu√≠das"}),e.jsx("div",{className:"bar-track",children:e.jsx("div",{className:"bar-fill green",style:{width:`${p.totalOrdens>0?p.ordensConcluidas/p.totalOrdens*100:0}%`},children:e.jsx("span",{className:"bar-value",children:p.ordensConcluidas})})})]}),e.jsxs("div",{className:"bar-item",children:[e.jsx("div",{className:"bar-label",children:"Em Andamento"}),e.jsx("div",{className:"bar-track",children:e.jsx("div",{className:"bar-fill orange",style:{width:`${p.totalOrdens>0?p.ordensEmAndamento/p.totalOrdens*100:0}%`},children:e.jsx("span",{className:"bar-value",children:p.ordensEmAndamento})})})]}),e.jsxs("div",{className:"bar-item",children:[e.jsx("div",{className:"bar-label",children:"Planejadas"}),e.jsx("div",{className:"bar-track",children:e.jsx("div",{className:"bar-fill gray",style:{width:`${p.totalOrdens>0?(p.totalOrdens-p.ordensConcluidas-p.ordensEmAndamento)/p.totalOrdens*100:0}%`},children:e.jsx("span",{className:"bar-value",children:p.totalOrdens-p.ordensConcluidas-p.ordensEmAndamento})})})]})]})]}),e.jsxs("div",{className:"chart-container",children:[e.jsx("h4",{className:"chart-title",children:"Top 5 Produtos Mais Produzidos"}),e.jsx("div",{className:"produtos-ranking",children:z().map((P,w)=>e.jsxs("div",{className:"ranking-item",children:[e.jsx("span",{className:"ranking-position",children:w+1}),e.jsx("span",{className:"ranking-nome",children:P.nome}),e.jsx("span",{className:"ranking-badge",children:P.quantidade})]},w))})]}),e.jsxs("div",{className:"info-card",children:[e.jsx(Oa,{size:20}),e.jsxs("div",{children:[e.jsx("strong",{children:"Tempo M√©dio por Etapa"}),e.jsxs("p",{children:[p.tempoMedioPorEtapa.toFixed(1)," dias"]})]})]})]}),a==="performance"&&e.jsxs("div",{className:"relatorio-section",children:[e.jsx("h3",{className:"section-title",children:"Relat√≥rio de Performance"}),e.jsxs("div",{className:"chart-container",children:[e.jsx("h4",{className:"chart-title",children:"Fac√ß√µes Mais Produtivas"}),e.jsx("div",{className:"faccoes-ranking",children:g.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx(Oe,{size:48}),e.jsx("p",{children:"Nenhum dado de performance dispon√≠vel ainda"})]}):g.map((P,w)=>e.jsxs("div",{className:"faccao-performance-card",children:[e.jsxs("div",{className:"faccao-header",children:[e.jsxs("span",{className:"faccao-position",children:[w+1,"¬∫"]}),e.jsx("h5",{className:"faccao-nome",children:P.faccaoNome})]}),e.jsxs("div",{className:"faccao-stats",children:[e.jsxs("div",{className:"faccao-stat",children:[e.jsx("span",{className:"stat-label",children:"Ordens Finalizadas"}),e.jsx("span",{className:"stat-value",children:P.ordensFinalizadas})]}),e.jsxs("div",{className:"faccao-stat",children:[e.jsx("span",{className:"stat-label",children:"Tempo M√©dio"}),e.jsxs("span",{className:"stat-value",children:[P.tempoMedio.toFixed(1)," dias"]})]}),e.jsxs("div",{className:"faccao-stat",children:[e.jsx("span",{className:"stat-label",children:"Taxa de Defeitos"}),e.jsxs("span",{className:`stat-value ${P.taxaDefeitos>5?"high":"low"}`,children:[P.taxaDefeitos.toFixed(1),"%"]})]})]})]},w))})]}),e.jsxs("div",{className:"metrics-grid",children:[e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon blue",children:e.jsx(Oe,{size:24})}),e.jsxs("div",{className:"metric-info",children:[e.jsx("span",{className:"metric-label",children:"Fac√ß√µes Ativas"}),e.jsx("span",{className:"metric-value",children:f.length})]})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon green",children:e.jsx(ze,{size:24})}),e.jsxs("div",{className:"metric-info",children:[e.jsx("span",{className:"metric-label",children:"Produtos Cadastrados"}),e.jsx("span",{className:"metric-value",children:c.length})]})]})]})]})]})]})},yt=()=>{const[s,a]=d.useState("dashboard"),t=n=>{a(n)},o=()=>{switch(s){case"dashboard":return e.jsx(Pa,{});case"cadastros":return e.jsx(et,{onTabChange:t});case"faccoes":return e.jsx(st,{});case"etapas":return e.jsx(rt,{});case"produto":return e.jsx(dt,{});case"ordemProducoes":return e.jsx(ft,{});case"gestaoProducoes":return e.jsx(gt,{});case"financeiro":return e.jsx(Nt,{});case"relatorios":return e.jsx(bt,{});default:return e.jsx(Pa,{})}};return e.jsx(Bs,{activeTab:s,onTabChange:t,children:e.jsx("div",{className:"dashboard-container",children:o()})})},wt=()=>{const s=la(),[a,t]=d.useState(null),[o,n]=d.useState(!1),[r,i]=d.useState({email:""}),l=c=>{i(x=>({...x,[c.target.name]:c.target.value}))},u=async c=>{if(c.preventDefault(),!r.email){t("Por favor, preencha o email");return}try{n(!0),t(null),await qe.resetPassword(r.email),alert("Email de recupera√ß√£o enviado com sucesso")}catch(x){const f=Ie(x);t(f)}finally{n(!1)}};return e.jsx("div",{className:"forgot-password-container",children:e.jsx("div",{className:"forgot-password-form-container",children:e.jsxs("div",{className:"forgot-password-form-card",children:[e.jsxs("div",{className:"forgot-password-header",children:[e.jsx("h2",{className:"forgot-password-title",children:"Recuperar Senha"}),e.jsx("p",{className:"forgot-password-subtitle",children:"Ola! Digite seu email para receber um link de recupera√ß√£o de senha"})]}),e.jsxs("form",{className:"forgot-password-form",onSubmit:u,children:[a&&e.jsx("div",{className:"forgot-password-error",children:a}),e.jsxs("div",{className:"forgot-password-field",children:[e.jsx("label",{className:"forgot-password-label",htmlFor:"email",children:"Email"}),e.jsx("input",{className:"forgot-password-input",id:"email",name:"email",type:"email",required:!0,value:r.email,onChange:l,placeholder:"Digite seu email"})]}),e.jsxs("div",{className:"forgot-password-buttons",children:[e.jsx("button",{className:"form-actions-button",type:"button",onClick:()=>s(je.login),children:"Cancelar"}),e.jsx("button",{className:"form-actions-button",type:"submit",disabled:o,children:o?"Enviando...":"Enviar"})]})]}),e.jsx("div",{className:"forgot-password-footer",children:e.jsxs("span",{className:"forgot-password-footer-text",children:["Voltar para"," ",e.jsx(na,{className:"forgot-password-footer-link",to:je.login,children:"Login"})]})})]})})})},Ct=()=>e.jsx(As,{children:e.jsxs(Ts,{children:[e.jsx(Ve,{path:je.home,element:e.jsx(wa,{})}),e.jsx(Ve,{path:je.login,element:e.jsx(wa,{})}),e.jsx(Ve,{path:je.register,element:e.jsx(qs,{})}),e.jsx(Ve,{path:je.forgotPassword,element:e.jsx(wt,{})}),e.jsx(Ve,{path:je.dashboard,element:e.jsx(Ls,{children:e.jsx(yt,{})})})]})});function Et(){return e.jsxs(_s,{children:[e.jsx(Ct,{}),e.jsx(xs,{position:"top-right",reverseOrder:!1,gutter:8,toastOptions:{duration:3500,style:{background:"rgba(255, 255, 255, 0.98)",color:"#1a202c",borderRadius:"16px",padding:"16px 24px",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",backdropFilter:"blur(16px)",border:"1px solid rgba(0, 0, 0, 0.05)",fontSize:"15px",fontWeight:"500",maxWidth:"420px",display:"flex",alignItems:"center",gap:"12px"},success:{duration:3e3,style:{background:"linear-gradient(135deg, rgba(16, 185, 129, 0.95) 0%, rgba(5, 150, 105, 0.95) 100%)",color:"#fff",boxShadow:"0 20px 25px -5px rgba(16, 185, 129, 0.3), 0 10px 10px -5px rgba(16, 185, 129, 0.2)"},iconTheme:{primary:"#fff",secondary:"#10b981"}},error:{duration:4e3,style:{background:"linear-gradient(135deg, rgba(239, 68, 68, 0.95) 0%, rgba(220, 38, 38, 0.95) 100%)",color:"#fff",boxShadow:"0 20px 25px -5px rgba(239, 68, 68, 0.3), 0 10px 10px -5px rgba(239, 68, 68, 0.2)"},iconTheme:{primary:"#fff",secondary:"#ef4444"}},loading:{style:{background:"linear-gradient(135deg, rgba(59, 130, 246, 0.95) 0%, rgba(37, 99, 235, 0.95) 100%)",color:"#fff",boxShadow:"0 20px 25px -5px rgba(59, 130, 246, 0.3), 0 10px 10px -5px rgba(59, 130, 246, 0.2)"},iconTheme:{primary:"#fff",secondary:"#3b82f6"}}}})]})}fs.createRoot(document.getElementById("root")).render(e.jsx(d.StrictMode,{children:e.jsx(Et,{})}));
